<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSentinel Pro - Advanced Cybersecurity Platform</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #00ff41;
            --secondary-color: #0066cc;
            --accent-color: #ff6b35;
            --warning-color: #ffaa00;
            --danger-color: #ff3366;
            --success-color: #00cc66;
            --bg-primary: #0a0a0f;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --bg-glass: rgba(22, 33, 62, 0.8);
            --text-primary: #ffffff;
            --text-secondary: #b0b7c3;
            --border-color: #333c57;
            --glow-color: rgba(0, 255, 65, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, #0f1419 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background particles */
        .bg-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--primary-color);
            border-radius: 50%;
            animation: float 6s infinite linear;
            opacity: 0.6;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Header */
        .header {
            position: relative;
            z-index: 10;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--primary-color);
            padding: 1rem 2rem;
            box-shadow: 0 4px 20px rgba(0, 255, 65, 0.2);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .logo-text {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-indicators {
            display: flex;
            gap: 1rem;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-glass);
            border-radius: 20px;
            border: 1px solid var(--border-color);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }

        .status-online { background: var(--success-color); }
        .status-scanning { background: var(--warning-color); }
        .status-offline { background: var(--danger-color); }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        /* Main container */
        .container {
            position: relative;
            z-index: 5;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Dashboard grid */
        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            min-height: calc(100vh - 120px);
        }

        /* Sidebar */
        .sidebar {
            background: var(--bg-glass);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            padding: 2rem;
            height: fit-content;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 1rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }

        .nav-link:hover,
        .nav-link.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--bg-primary);
            transform: translateX(10px);
            box-shadow: 0 4px 15px var(--glow-color);
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-icon {
            font-size: 1.3rem;
            width: 24px;
            text-align: center;
        }

        /* Main content */
        .main-content {
            background: var(--bg-glass);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            animation: scan 3s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Content sections */
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--bg-card), rgba(22, 33, 62, 0.5));
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 255, 65, 0.15);
            border-color: var(--primary-color);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary-color);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .stat-card:hover::before {
            transform: translateX(0);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-icon {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            color: var(--primary-color);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Scan interface */
        .scan-interface {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .scan-controls {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 1rem;
            align-items: end;
        }

        .input-group {
            position: relative;
        }

        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
        }

        .input-field {
            width: 100%;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: 'Rajdhani', sans-serif;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 15px var(--glow-color);
        }

        .select-field {
            width: 100%;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .select-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 15px var(--glow-color);
        }

        /* Buttons */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Rajdhani', sans-serif;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--bg-primary);
            box-shadow: 0 4px 15px rgba(0, 255, 65, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 65, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--accent-color), var(--warning-color));
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        /* Results area */
        .results-container {
            background: var(--bg-card);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        .results-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .results-content {
            padding: 1.5rem;
            max-height: 500px;
            overflow-y: auto;
        }

        .results-content::-webkit-scrollbar {
            width: 8px;
        }

        .results-content::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        .results-content::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        /* Terminal-style output */
        .terminal-output {
            background: #000;
            border-radius: 10px;
            padding: 1.5rem;
            font-family: 'Courier New', monospace;
            color: var(--primary-color);
            min-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            position: relative;
        }

        .terminal-output::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--primary-color);
            animation: terminal-scan 2s linear infinite;
        }

        @keyframes terminal-scan {
            0% { opacity: 0; transform: translateX(-100%); }
            50% { opacity: 1; }
            100% { opacity: 0; transform: translateX(100%); }
        }

        .terminal-line {
            margin-bottom: 0.5rem;
            animation: typewriter 0.1s ease-in-out;
        }

        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }

        /* Loading animation */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .dashboard {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .sidebar {
                order: 2;
            }

            .main-content {
                order: 1;
            }

            .scan-controls {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 1rem;
            }
        }

        /* Vulnerability severity indicators */
        .severity-critical { color: var(--danger-color); }
        .severity-high { color: var(--accent-color); }
        .severity-medium { color: var(--warning-color); }
        .severity-low { color: var(--success-color); }
        .severity-info { color: var(--text-secondary); }

        /* Progress bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, .2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, .2) 50%,
                rgba(255, 255, 255, .2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 50px 50px;
            animation: move 2s linear infinite;
        }

        @keyframes move {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }

        /* Novel modules */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .module-card {
            background: linear-gradient(160deg, rgba(10, 10, 40, 0.9), rgba(0, 80, 120, 0.35));
            border-radius: 18px;
            border: 1px solid rgba(0, 255, 65, 0.15);
            padding: 1.75rem;
            position: relative;
            overflow: hidden;
            transition: transform 0.4s ease, border-color 0.4s ease;
        }

        .module-card:hover {
            transform: translateY(-6px) scale(1.01);
            border-color: var(--primary-color);
            box-shadow: 0 18px 40px rgba(0, 255, 65, 0.18);
        }

        .module-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top right, rgba(0, 255, 65, 0.25), transparent 55%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .module-card:hover::after {
            opacity: 1;
        }

        .module-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.4rem;
            letter-spacing: 1px;
            margin-bottom: 0.75rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .module-title i {
            font-size: 1.5rem;
        }

        .module-description {
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }

        .module-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .module-tag {
            padding: 0.35rem 0.75rem;
            border-radius: 999px;
            background: rgba(0, 255, 65, 0.12);
            border: 1px solid rgba(0, 255, 65, 0.35);
            color: var(--primary-color);
            font-size: 0.75rem;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .novel-console {
            background: rgba(4, 8, 20, 0.85);
            border-radius: 14px;
            border: 1px solid rgba(0, 255, 65, 0.15);
            padding: 1.5rem;
            font-family: 'Courier New', monospace;
            color: var(--primary-color);
            min-height: 200px;
            overflow-y: auto;
            position: relative;
        }

        .novel-console::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.6), transparent);
            animation: terminal-scan 3s linear infinite;
        }

        .novel-console-line {
            margin-bottom: 0.4rem;
            white-space: pre-wrap;
        }

        .timeline-track {
            position: relative;
            padding-left: 1.5rem;
            margin-left: 0.5rem;
            border-left: 2px solid rgba(0, 255, 65, 0.25);
        }

        .timeline-event {
            position: relative;
            margin-bottom: 1.5rem;
            padding-left: 1rem;
        }

        .timeline-event::before {
            content: '';
            position: absolute;
            top: 0.4rem;
            left: -1.75rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary-color);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
        }

        .timeline-event h4 {
            margin-bottom: 0.3rem;
            color: var(--primary-color);
            font-size: 1rem;
        }

        .matrix-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .matrix-cell {
            background: rgba(0, 0, 0, 0.35);
            border: 1px dashed rgba(0, 255, 65, 0.35);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: transform 0.3s ease, background 0.3s ease;
        }

        .matrix-cell:hover {
            transform: translateY(-4px);
            background: rgba(0, 255, 65, 0.08);
        }

        .matrix-cell span {
            display: block;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .quantum-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 2rem;
            align-items: center;
            margin: 2rem 0;
        }

        .radial-gauge {
            position: relative;
            width: 240px;
            height: 240px;
            border-radius: 50%;
            background: radial-gradient(circle at center, rgba(0, 255, 65, 0.25), rgba(10, 10, 25, 0.9) 60%);
            border: 2px solid rgba(0, 255, 65, 0.35);
            box-shadow: inset 0 0 20px rgba(0, 255, 65, 0.15), 0 0 30px rgba(0, 255, 65, 0.25);
            margin: 0 auto;
        }

        .gauge-needle {
            position: absolute;
            width: 4px;
            height: 90px;
            background: linear-gradient(180deg, rgba(0, 255, 65, 0.9), rgba(0, 255, 65, 0));
            top: 30px;
            left: 50%;
            transform-origin: 50% 100%;
            transform: rotate(0deg);
            transition: transform 0.8s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .gauge-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: radial-gradient(circle at center, rgba(0, 255, 65, 0.8), rgba(10, 10, 25, 0.9));
            border: 2px solid rgba(0, 255, 65, 0.6);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', monospace;
            color: var(--bg-primary);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.6);
        }

        .gauge-value {
            font-size: 1.4rem;
            font-weight: 700;
        }

        .gauge-label {
            font-size: 0.65rem;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .gauge-orbit {
            position: absolute;
            inset: 12px;
            border-radius: 50%;
            border: 1px dashed rgba(0, 255, 65, 0.25);
        }

        .memetic-canvas {
            background: rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(0, 255, 65, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            min-height: 220px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .memetic-node {
            padding: 1rem;
            background: rgba(0, 255, 65, 0.08);
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 65, 0.25);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .memetic-node::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent, rgba(0, 255, 65, 0.15));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .memetic-node:hover {
            transform: translateY(-4px);
        }

        .memetic-node:hover::after {
            opacity: 1;
        }

        .memetic-node strong {
            display: block;
            font-family: 'Orbitron', monospace;
            margin-bottom: 0.5rem;
        }

        /* Virtual Labs Styles */
        .vm-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1rem;
        }

        .vm-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .vm-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        .vm-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 204, 102, 0.15);
            border-color: var(--primary-color);
        }

        .vm-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .vm-header h4 {
            margin: 0;
            color: var(--primary-color);
            font-family: 'Orbitron', monospace;
        }

        .vm-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-online {
            background: rgba(0, 204, 102, 0.1);
            color: #00cc66;
            border: 1px solid rgba(0, 204, 102, 0.3);
        }

        .status-offline {
            background: rgba(102, 102, 102, 0.1);
            color: #666;
            border: 1px solid rgba(102, 102, 102, 0.3);
        }

        .status-paused {
            background: rgba(255, 193, 7, 0.1);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .vm-details {
            margin-bottom: 1rem;
        }

        .vm-details div {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .vm-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .btn-xs {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
            border-radius: 4px;
        }

        .vm-controls {
            background: linear-gradient(135deg, rgba(0, 204, 102, 0.05), rgba(0, 204, 102, 0.02));
            border: 1px solid rgba(0, 204, 102, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .vm-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .vm-grid {
                grid-template-columns: 1fr;
            }

            .vm-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .vm-actions {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Animated background particles -->
    <div class="bg-particles" id="particles"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-shield-alt logo-icon"></i>
                <span class="logo-text">CyberSentinel Pro</span>
            </div>
            <div class="status-indicators">
                <div class="status-item">
                    <div class="status-dot status-online" id="apiStatus"></div>
                    <span>API Server</span>
                </div>
                <div class="status-item">
                    <div class="status-dot status-offline" id="scanStatus"></div>
                    <span>Scanner</span>
                </div>
                <div class="status-item">
                    <div class="status-dot status-online" id="aiStatus"></div>
                    <span>AI Engine</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main container -->
    <div class="container">
        <div class="dashboard">
            <!-- Sidebar -->
            <nav class="sidebar">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#dashboard" class="nav-link active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt nav-icon"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#network-scan" class="nav-link" data-section="network-scan">
                            <i class="fas fa-network-wired nav-icon"></i>
                            <span>Network Scan</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#web-scan" class="nav-link" data-section="web-scan">
                            <i class="fas fa-globe nav-icon"></i>
                            <span>Web Vulnerability</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#predictive-defense" class="nav-link" data-section="predictive-defense">
                            <i class="fas fa-bolt nav-icon"></i>
                            <span>Predictive Defense</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#deception-lab" class="nav-link" data-section="deception-lab">
                            <i class="fas fa-chess-knight nav-icon"></i>
                            <span>Deception Mesh</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#posture-twin" class="nav-link" data-section="posture-twin">
                            <i class="fas fa-project-diagram nav-icon"></i>
                            <span>Posture Twin</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#quantum-prism" class="nav-link" data-section="quantum-prism">
                            <i class="fas fa-atom nav-icon"></i>
                            <span>Quantum Prism</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#virtual-labs" class="nav-link" data-section="virtual-labs">
                            <i class="fas fa-server nav-icon"></i>
                            <span>Virtual Labs</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#threat-intel" class="nav-link" data-section="threat-intel">
                            <i class="fas fa-rss nav-icon"></i>
                            <span>Threat Intel</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#remediation" class="nav-link" data-section="remediation">
                            <i class="fas fa-tools nav-icon"></i>
                            <span>Remediation</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#incident-response" class="nav-link" data-section="incident-response">
                            <i class="fas fa-shield-alt nav-icon"></i>
                            <span>Incident Response</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#compliance" class="nav-link" data-section="compliance">
                            <i class="fas fa-clipboard-check nav-icon"></i>
                            <span>Compliance</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#traffic-analysis" class="nav-link" data-section="traffic-analysis">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span>Traffic Analysis</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#malware-sandbox" class="nav-link" data-section="malware-sandbox">
                            <i class="fas fa-virus nav-icon"></i>
                            <span>Malware Sandbox</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#collaboration" class="nav-link" data-section="collaboration">
                            <i class="fas fa-users nav-icon"></i>
                            <span>Collaboration</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#cloud-security" class="nav-link" data-section="cloud-security">
                            <i class="fas fa-cloud nav-icon"></i>
                            <span>Cloud Security</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#auto-pentest" class="nav-link" data-section="auto-pentest">
                            <i class="fas fa-robot nav-icon"></i>
                            <span>Auto Pentest</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#backup-recovery" class="nav-link" data-section="backup-recovery">
                            <i class="fas fa-database nav-icon"></i>
                            <span>Backup & Recovery</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#ai-analysis" class="nav-link" data-section="ai-analysis">
                            <i class="fas fa-robot nav-icon"></i>
                            <span>AI Analysis</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#reports" class="nav-link" data-section="reports">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#settings" class="nav-link" data-section="settings">
                            <i class="fas fa-cog nav-icon"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- Main content -->
            <main class="main-content">
                <!-- Dashboard Section -->
                <div class="content-section active" id="dashboard">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        <i class="fas fa-shield-alt"></i> Security Dashboard
                    </h1>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-server"></i>
                                </div>
                                <div class="stat-value" id="hostsScanned">0</div>
                            </div>
                            <div class="stat-label">Hosts Scanned</div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-bug"></i>
                                </div>
                                <div class="stat-value" id="vulnerabilities">0</div>
                            </div>
                            <div class="stat-label">Vulnerabilities Found</div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-value" id="criticalIssues">0</div>
                            </div>
                            <div class="stat-label">Critical Issues</div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-history"></i>
                                </div>
                                <div class="stat-value" id="lastScanTime">Never</div>
                            </div>
                            <div class="stat-label">Last Scan</div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-chart-bar"></i> Recent Activity</h3>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="activityLog">
[SYSTEM] CyberSentinel Pro initialized successfully
[INFO] All security modules loaded
[STATUS] Ready for penetration testing operations
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Network Scan Section -->
                <div class="content-section" id="network-scan">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-network-wired"></i> Network Scanner
                    </h1>

                    <div class="scan-interface">
                        <div class="scan-controls">
                            <div class="input-group">
                                <label class="input-label" for="networkTarget">Target Network</label>
                                <input type="text" id="networkTarget" class="input-field"
                                       placeholder="e.g., 192.168.1.0/24 or example.com"
                                       value="127.0.0.1">
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="scanType">Scan Type</label>
                                <select id="scanType" class="select-field">
                                    <option value="quick">Quick Scan</option>
                                    <option value="full">Full Scan</option>
                                    <option value="custom">Custom Ports</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <button class="btn btn-primary" onclick="startNetworkScan()">
                                    <i class="fas fa-play"></i> Start Scan
                                </button>
                            </div>
                        </div>

                        <div class="progress-bar" id="networkProgress" style="display: none;">
                            <div class="progress-fill" id="networkProgressFill"></div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-list"></i> Scan Results</h3>
                            <button class="btn btn-secondary" onclick="exportResults('network')" style="display: none;" id="exportNetworkBtn">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="networkResults">
Waiting for scan to start...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Web Scan Section -->
                <div class="content-section" id="web-scan">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-globe"></i> Web Vulnerability Scanner
                    </h1>

                    <div class="scan-interface">
                        <div class="scan-controls">
                            <div class="input-group">
                                <label class="input-label" for="webTarget">Target URL</label>
                                <input type="text" id="webTarget" class="input-field"
                                       placeholder="https://example.com"
                                       value="http://localhost:8000">
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="webScanType">Scan Depth</label>
                                <select id="webScanType" class="select-field">
                                    <option value="basic">Basic Scan</option>
                                    <option value="comprehensive">Comprehensive</option>
                                    <option value="aggressive">Aggressive</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <button class="btn btn-primary" onclick="startWebScan()">
                                    <i class="fas fa-search"></i> Scan Website
                                </button>
                            </div>
                        </div>

                        <div class="progress-bar" id="webProgress" style="display: none;">
                            <div class="progress-fill" id="webProgressFill"></div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-bug"></i> Vulnerabilities Found</h3>
                            <button class="btn btn-secondary" onclick="exportResults('web')" style="display: none;" id="exportWebBtn">
                                <i class="fas fa-download"></i> Export Report
                            </button>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="webResults">
Ready to scan web applications for vulnerabilities...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Predictive Defense Section -->
                <div class="content-section" id="predictive-defense">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        <i class="fas fa-bolt"></i> Hyperion Predictive Defense
                    </h1>

                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-wave-square"></i> Temporal Threat Forecaster</div>
                            <p class="module-description">Projects emerging attack patterns by fusing live telemetry with historical breach cartography. Generates forward-facing narratives of how adversaries could pivot in the next 72 hours.</p>
                            <div class="module-meta">
                                <span class="module-tag">72h horizon</span>
                                <span class="module-tag">synthetic intel</span>
                                <span class="module-tag">adaptive AI</span>
                            </div>
                            <button class="btn btn-primary" onclick="runPredictiveDefense(this, 'temporal')">
                                <i class="fas fa-forward"></i> Forecast Trajectory
                            </button>
                        </div>

                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-brain"></i> Adversarial Persona Composer</div>
                            <p class="module-description">Synthesizes probabilistic adversary personas using multi-signal telemetry (insider drift, supply-chain anomalies, geopolitical tension) to anticipate unconventional exploit chains.</p>
                            <div class="module-meta">
                                <span class="module-tag">persona dna</span>
                                <span class="module-tag">signal fusion</span>
                            </div>
                            <button class="btn btn-primary" onclick="runPredictiveDefense(this, 'persona')">
                                <i class="fas fa-user-secret"></i> Generate Persona Atlas
                            </button>
                        </div>

                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-satellite-dish"></i> Zero-Day Harmonics Radar</div>
                            <p class="module-description">Listens for resonance shifts across exploit chatter, dark telemetry, and code repository differentials to surface zero-day signatures before weaponization completes.</p>
                            <div class="module-meta">
                                <span class="module-tag">pre-zero-day</span>
                                <span class="module-tag">signal resonance</span>
                            </div>
                            <button class="btn btn-primary" onclick="runPredictiveDefense(this, 'harmonics')">
                                <i class="fas fa-broadcast-tower"></i> Scan Harmonics
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-chart-area"></i> Predictive Intelligence Console</h3>
                            <button class="btn btn-secondary" onclick="exportNovelResults('predictive')" id="exportPredictiveBtn" style="display: none;">
                                <i class="fas fa-download"></i> Export Horizon Map
                            </button>
                        </div>
                        <div class="results-content">
                            <div class="novel-console" id="predictiveConsole">
// Hyperion Predictive Defense ready.
// Select a module to project future-state adversarial narratives.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Deception Mesh Section -->
                <div class="content-section" id="deception-lab">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-chess-knight"></i> GIS Deception Mesh Lab
                    </h1>

                    <div class="module-grid">
                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-magic"></i> Honey Artifact Synthesizer</div>
                            <p class="module-description">Generates high-fidelity honey services, documents, and credentials that reflect your live topology yet remain sandbox-isolated to capture adversarial intent signatures.</p>
                            <div class="module-meta">
                                <span class="module-tag">synthetic lures</span>
                                <span class="module-tag">telemetry traps</span>
                            </div>
                            <button class="btn btn-primary" onclick="generateDeceptionMesh(this)">
                                <i class="fas fa-chess"></i> Synthesize Mesh
                            </button>
                        </div>

                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-bezier-curve"></i> Mirage Route Orchestrator</div>
                            <p class="module-description">Designs deceptive network paths that dynamically reroute intruders through invisibly monitored corridors, recording behavioral fingerprints in real time.</p>
                            <div class="module-meta">
                                <span class="module-tag">dynamic lox</span>
                                <span class="module-tag">behavioral capture</span>
                            </div>
                            <button class="btn btn-primary" onclick="generateDeceptionMesh(this, 'routes')">
                                <i class="fas fa-route"></i> Orchestrate Mirage
                            </button>
                        </div>

                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-fingerprint"></i> Counter-Intelligence Telemetry Loom</div>
                            <p class="module-description">Weaves the captured deception signals into adversary dossiers, mapping toolchain lineage, pivot cadence, and exfil attempt probabilities.</p>
                            <div class="module-meta">
                                <span class="module-tag">counterintel fabric</span>
                                <span class="module-tag">forensic threads</span>
                            </div>
                            <button class="btn btn-primary" onclick="generateDeceptionMesh(this, 'telemetry')">
                                <i class="fas fa-spider"></i> Loom Telemetry
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-chess-board"></i> Deception Mesh Matrix</h3>
                        </div>
                        <div class="results-content">
                            <div class="matrix-grid" id="meshMatrix"></div>
                            <div class="novel-console" id="deceptionConsole" style="margin-top: 1.5rem;">
// GIS mesh idle.
// Deploy synthetic lures to begin adaptive counter-intelligence capture.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Posture Twin Section -->
                <div class="content-section" id="posture-twin">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-project-diagram"></i> Sentient Posture Twin Simulator
                    </h1>

                    <div class="module-grid">
                        <div class="module-card" style="grid-column: span 2;">
                            <div class="module-title"><i class="fas fa-sliders-h"></i> Continuum Timeline Control</div>
                            <p class="module-description">Scrub through a living digital twin of your estate. Each increment projects posture drift, control health, and adversarial footholds based on autonomous telemetry curation.</p>
                            <div class="module-meta">
                                <span class="module-tag">digital twin</span>
                                <span class="module-tag">continuous controls</span>
                                <span class="module-tag">48h dramaturgy</span>
                            </div>
                            <input type="range" id="twinTimeline" min="0" max="48" value="12" oninput="updateTwinTimeline(this.value)" style="width: 100%; margin: 1rem 0;">
                            <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-secondary);">
                                <span>Now</span>
                                <span id="twinMarker">+12h</span>
                                <span>+48h</span>
                            </div>
                        </div>
                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-vial"></i> Simulation Synopsis</div>
                            <div class="module-description" id="twinSynopsis">Select a future point to project defensive posture.</div>
                            <button class="btn btn-primary" onclick="runPostureSimulation(this)">
                                <i class="fas fa-play-circle"></i> Run Scenario Weave
                            </button>
                        </div>
                        <div class="module-card">
                            <div class="module-title"><i class="fas fa-seedling"></i> Resilience Trajectory</div>
                            <div class="module-description" id="resilienceScore">Baseline resilience steady at 78%. Awaiting simulation.</div>
                            <button class="btn btn-secondary" onclick="exportNovelResults('twin')">
                                <i class="fas fa-share-alt"></i> Export Trajectory
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-stream"></i> Projected Event Stream</h3>
                        </div>
                        <div class="results-content">
                            <div class="timeline-track" id="twinTimelineEvents"></div>
                            <div class="novel-console" id="twinConsole" style="margin-top: 1.5rem;">
// Digital twin calibrated.
// Manipulate the timeline to orchestrate resilience rehearsals.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quantum Prism Section -->
                <div class="content-section" id="quantum-prism">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        <i class="fas fa-atom"></i> Quantum Risk Prism Forge
                    </h1>

                    <p style="color: var(--text-secondary); max-width: 720px; margin-bottom: 2rem;">
                        The Quantum Risk Prism synthesizes coherence collapse telemetry, supply-chain memetics, and ambient threat harmonics into an interactive risk field.
                        It expresses risk not as a static score, but as an evolving quantum waveform that reacts to your inputs in real-time.
                    </p>

                    <div style="margin-bottom: 1.5rem; padding: 1rem 1.25rem; border: 1px solid var(--border-color); border-radius: 12px; background: rgba(255, 107, 53, 0.08); color: var(--text-secondary);">
                        <strong style="display: block; color: var(--accent-color); margin-bottom: 0.35rem;">Current status</strong>
                        Quantum Prism interactions are simulated visualizations. Backend integration is planned but not yet available, so pulses update the gauge and log locally only.
                    </div>

                    <div class="quantum-grid">
                        <div>
                            <div class="module-card">
                                <div class="module-title"><i class="fas fa-compact-disc"></i> Coherence Collapse Gauge</div>
                                <p class="module-description">Measures the probability amplitude of simultaneous exploit vectors converging on mission-critical surfaces. Reactive to current scan telemetry and memetic resonance.</p>
                                <div class="radial-gauge">
                                    <div class="gauge-orbit"></div>
                                    <div class="gauge-needle" id="gaugeNeedle"></div>
                                    <div class="gauge-center">
                                        <div class="gauge-value" id="gaugeValue">37</div>
                                        <div class="gauge-label">coherence</div>
                                    </div>
                                </div>
                                <div style="margin-top: 1.5rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                    <button class="btn btn-primary" onclick="triggerQuantumPulse('supply_chain')"><i class="fas fa-industry"></i> Supply-Chain Pulse</button>
                                    <button class="btn btn-secondary" onclick="triggerQuantumPulse('insider')"><i class="fas fa-user-ninja"></i> Insider Flux</button>
                                    <button class="btn btn-primary" onclick="triggerQuantumPulse('zero_day')"><i class="fas fa-star"></i> Zero-Day Bloom</button>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="module-card">
                                <div class="module-title"><i class="fas fa-share-alt"></i> Memetic Supply-Chain Atlas</div>
                                <p class="module-description">Charts narrative drift across partner ecosystems, blending threat intel gossip, procurement anomalies, and socio-technical signals into actionable resonance clusters.</p>
                                <div class="memetic-canvas" id="memeticCanvas"></div>
                                <div style="margin-top: 1.25rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                    <button class="btn btn-primary" onclick="synthesizeMemeticThreat('collusion')"><i class="fas fa-link"></i> Collusion Thread</button>
                                    <button class="btn btn-secondary" onclick="synthesizeMemeticThreat('disruption')"><i class="fas fa-bolt"></i> Disruption Wave</button>
                                    <button class="btn btn-primary" onclick="synthesizeMemeticThreat('espionage')"><i class="fas fa-mask"></i> Espionage Signal</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-globe"></i> Quantum Telemetry Stream</h3>
                            <button class="btn btn-secondary" onclick="exportNovelResults('quantum')">
                                <i class="fas fa-download"></i> Export Quantum Field
                            </button>
                        </div>
                        <div class="results-content">
                            <div class="novel-console" id="quantumConsole">
// Quantum prism stabilized.
// Invoke pulses to observe coherence collapse and memetic flux reactions.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Analysis Section -->
                <div class="content-section" id="ai-analysis">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-robot"></i> AI Security Analysis
                    </h1>

                    <div class="scan-interface">
                        <div class="scan-controls">
                            <div class="input-group">
                                <label class="input-label" for="aiInput">Analysis Input</label>
                                <select id="aiInputType" class="select-field">
                                    <option value="latest">Latest Scan Results</option>
                                    <option value="custom">Custom Data</option>
                                    <option value="threat">Threat Intelligence</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="aiModel">AI Model</label>
                                <select id="aiModel" class="select-field">
                                    <option value="gpt-4">GPT-4 (Recommended)</option>
                                    <option value="gpt-3.5">GPT-3.5 Turbo</option>
                                    <option value="claude">Claude</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <button class="btn btn-primary" onclick="startAIAnalysis()">
                                    <i class="fas fa-brain"></i> Analyze
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-lightbulb"></i> AI Insights & Recommendations</h3>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="aiResults">
                                <div id="aiConfigMessage" style="display: block;">
                                    AI Analysis Engine ready. Configure your OpenAI API key in settings to begin.
                                </div>
                                <div id="aiReadyMessage" style="display: none;">
                                    AI Analysis Engine ready and configured. Select analysis type above to begin.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reports Section -->
                <div class="content-section" id="reports">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-chart-line"></i> Security Reports
                    </h1>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="stat-value" id="totalReports">0</div>
                            </div>
                            <div class="stat-label">Total Reports</div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar"></i>
                                </div>
                                <div class="stat-value" id="reportsThisMonth">0</div>
                            </div>
                            <div class="stat-label">This Month</div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-folder-open"></i> Recent Reports</h3>
                            <button class="btn btn-primary" onclick="generateReport()">
                                <i class="fas fa-plus"></i> Generate Report
                            </button>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="reportsList">
No reports generated yet. Run some scans first!
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Virtual Labs Section -->
                <div class="content-section" id="virtual-labs">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-server"></i> Virtual Labs
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-cloud"></i> VM Management Console
                        </h3>

                        <div class="vm-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="vmProvider">Virtualization Provider</label>
                                <select id="vmProvider" class="input-field">
                                    <option value="virtualbox">VirtualBox</option>
                                    <option value="vmware">VMware Workstation</option>
                                    <option value="hyperv">Hyper-V</option>
                                    <option value="qemu">QEMU/KVM</option>
                                    <option value="aws">AWS EC2</option>
                                    <option value="azure">Azure VMs</option>
                                    <option value="gcp">Google Cloud</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="vmAction">Action</label>
                                <select id="vmAction" class="input-field">
                                    <option value="list">List VMs</option>
                                    <option value="start">Start VM</option>
                                    <option value="stop">Stop VM</option>
                                    <option value="create">Create VM</option>
                                    <option value="delete">Delete VM</option>
                                    <option value="snapshot">Take Snapshot</option>
                                    <option value="clone">Clone VM</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="vmName">VM Name/ID</label>
                                <input type="text" id="vmName" class="input-field" placeholder="Enter VM name or ID">
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="vmTemplate">Template (for creation)</label>
                                <select id="vmTemplate" class="input-field">
                                    <option value="kali-linux">Kali Linux (Pen Testing)</option>
                                    <option value="ubuntu-server">Ubuntu Server</option>
                                    <option value="windows-10">Windows 10</option>
                                    <option value="metasploitable">Metasploitable</option>
                                    <option value="owasp-zap">OWASP ZAP</option>
                                    <option value="custom">Custom ISO</option>
                                </select>
                            </div>
                        </div>

                        <div class="vm-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="executeVMAction()">
                                <i class="fas fa-play"></i> Execute Action
                            </button>
                            <button class="btn btn-secondary" onclick="refreshVMList()">
                                <i class="fas fa-sync"></i> Refresh List
                            </button>
                            <button class="btn btn-warning" onclick="connectToVM()">
                                <i class="fas fa-terminal"></i> Connect to VM
                            </button>
                            <button class="btn btn-info" onclick="exportVMConfig()">
                                <i class="fas fa-download"></i> Export Config
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-list"></i> VM Inventory</h3>
                            <div class="results-actions">
                                <button class="btn btn-sm btn-outline" onclick="filterVMs('running')">
                                    <i class="fas fa-circle" style="color: #00cc66;"></i> Running
                                </button>
                                <button class="btn btn-sm btn-outline" onclick="filterVMs('stopped')">
                                    <i class="fas fa-circle" style="color: #666;"></i> Stopped
                                </button>
                                <button class="btn btn-sm btn-outline" onclick="filterVMs('all')">
                                    <i class="fas fa-th-list"></i> All
                                </button>
                            </div>
                        </div>
                        <div class="results-content">
                            <div id="vmList" class="vm-grid">
                                <!-- VM entries will be populated here -->
                                <div class="vm-card" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-secondary);">
                                    <div class="vm-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: var(--primary-color);">Kali-Linux-01</h4>
                                        <span class="vm-status status-online" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Running</span>
                                    </div>
                                    <div class="vm-details" style="font-size: 0.9rem; color: var(--text-secondary);">
                                        <div><i class="fas fa-memory"></i> RAM: 4GB | <i class="fas fa-hdd"></i> Storage: 50GB</div>
                                        <div><i class="fas fa-network-wired"></i> IP: 192.168.56.101 | <i class="fas fa-clock"></i> Uptime: 2h 15m</div>
                                    </div>
                                    <div class="vm-actions" style="margin-top: 0.5rem;">
                                        <button class="btn btn-xs btn-danger" onclick="stopVM('Kali-Linux-01')">
                                            <i class="fas fa-stop"></i> Stop
                                        </button>
                                        <button class="btn btn-xs btn-info" onclick="connectVM('Kali-Linux-01')">
                                            <i class="fas fa-terminal"></i> Connect
                                        </button>
                                        <button class="btn btn-xs btn-secondary" onclick="snapshotVM('Kali-Linux-01')">
                                            <i class="fas fa-camera"></i> Snapshot
                                        </button>
                                    </div>
                                </div>

                                <div class="vm-card" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-secondary);">
                                    <div class="vm-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: var(--primary-color);">Metasploitable-3</h4>
                                        <span class="vm-status status-offline" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Stopped</span>
                                    </div>
                                    <div class="vm-details" style="font-size: 0.9rem; color: var(--text-secondary);">
                                        <div><i class="fas fa-memory"></i> RAM: 2GB | <i class="fas fa-hdd"></i> Storage: 30GB</div>
                                        <div><i class="fas fa-network-wired"></i> IP: N/A | <i class="fas fa-clock"></i> Last Run: 1 day ago</div>
                                    </div>
                                    <div class="vm-actions" style="margin-top: 0.5rem;">
                                        <button class="btn btn-xs btn-success" onclick="startVM('Metasploitable-3')">
                                            <i class="fas fa-play"></i> Start
                                        </button>
                                        <button class="btn btn-xs btn-info" onclick="connectVM('Metasploitable-3')">
                                            <i class="fas fa-terminal"></i> Connect
                                        </button>
                                        <button class="btn btn-xs btn-warning" onclick="configureVM('Metasploitable-3')">
                                            <i class="fas fa-cog"></i> Configure
                                        </button>
                                    </div>
                                </div>

                                <div class="vm-card" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-secondary);">
                                    <div class="vm-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: var(--primary-color);">Windows-10-Test</h4>
                                        <span class="vm-status status-paused" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Paused</span>
                                    </div>
                                    <div class="vm-details" style="font-size: 0.9rem; color: var(--text-secondary);">
                                        <div><i class="fas fa-memory"></i> RAM: 8GB | <i class="fas fa-hdd"></i> Storage: 100GB</div>
                                        <div><i class="fas fa-network-wired"></i> IP: 192.168.56.102 | <i class="fas fa-clock"></i> Uptime: 45m</div>
                                    </div>
                                    <div class="vm-actions" style="margin-top: 0.5rem;">
                                        <button class="btn btn-xs btn-success" onclick="resumeVM('Windows-10-Test')">
                                            <i class="fas fa-play"></i> Resume
                                        </button>
                                        <button class="btn btn-xs btn-info" onclick="connectVM('Windows-10-Test')">
                                            <i class="fas fa-desktop"></i> RDP
                                        </button>
                                        <button class="btn btn-xs btn-secondary" onclick="revertVM('Windows-10-Test')">
                                            <i class="fas fa-undo"></i> Revert
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-terminal"></i> VM Console Output</h3>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="vmConsole">
Welcome to CyberSentinel Virtual Labs Console
===========================================

Available Providers: VirtualBox, VMware, Hyper-V, QEMU/KVM, AWS, Azure, GCP
Current Provider: VirtualBox

[INFO] 3 VMs detected in inventory
[INFO] Ready for VM management operations

Type 'help' for available commands or use the GUI controls above.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Threat Intelligence Section -->
                <div class="content-section" id="threat-intel">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-rss"></i> Real-Time Threat Intelligence
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-globe"></i> Threat Intelligence Feeds
                        </h3>

                        <div class="threat-feeds-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="feed-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem;">
                                <div class="feed-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <h4 style="margin: 0; color: var(--primary-color);">MISP</h4>
                                    <span class="feed-status status-online" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Active</span>
                                </div>
                                <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Malware Information Sharing Platform</p>
                                <div class="feed-stats" style="font-size: 0.8rem; color: var(--text-secondary);">
                                    <div>Last Update: 2 min ago</div>
                                    <div>IOC Count: 1,247</div>
                                </div>
                            </div>

                            <div class="feed-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem;">
                                <div class="feed-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <h4 style="margin: 0; color: var(--primary-color);">OpenIOC</h4>
                                    <span class="feed-status status-online" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Active</span>
                                </div>
                                <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Mandiant Open Indicators of Compromise</p>
                                <div class="feed-stats" style="font-size: 0.8rem; color: var(--text-secondary);">
                                    <div>Last Update: 5 min ago</div>
                                    <div>IOC Count: 892</div>
                                </div>
                            </div>

                            <div class="feed-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem;">
                                <div class="feed-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <h4 style="margin: 0; color: var(--primary-color);">STIX/TAXII</h4>
                                    <span class="feed-status status-online" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Active</span>
                                </div>
                                <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Structured Threat Information Expression</p>
                                <div class="feed-stats" style="font-size: 0.8rem; color: var(--text-secondary);">
                                    <div>Last Update: 1 min ago</div>
                                    <div>IOC Count: 2,134</div>
                                </div>
                            </div>
                        </div>

                        <div class="threat-controls" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="refreshThreatFeeds()">
                                <i class="fas fa-sync"></i> Refresh Feeds
                            </button>
                            <button class="btn btn-secondary" onclick="runIOCCorrelation()">
                                <i class="fas fa-search"></i> IOC Correlation
                            </button>
                            <button class="btn btn-warning" onclick="generateThreatReport()">
                                <i class="fas fa-file"></i> Generate Report
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-exclamation-triangle"></i> Active Threats & Alerts</h3>
                        </div>
                        <div class="results-content">
                            <div id="threatAlerts" class="threat-alerts">
                                <div class="alert-item critical" style="border-left: 4px solid #ff4444; padding: 1rem; margin-bottom: 1rem; background: rgba(255, 68, 68, 0.1);">
                                    <div class="alert-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: #ff4444;">CRITICAL: Zero-Day Exploit Detected</h4>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary);">2 min ago</span>
                                    </div>
                                    <p style="margin: 0; color: var(--text-primary);">CVE-2025-0001 affecting Apache servers. Immediate patching required.</p>
                                    <div class="alert-meta" style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-secondary);">
                                        <span>Severity: Critical</span> | <span>Confidence: 95%</span> | <span>Source: MISP</span>
                                    </div>
                                </div>

                                <div class="alert-item high" style="border-left: 4px solid #ff8800; padding: 1rem; margin-bottom: 1rem; background: rgba(255, 136, 0, 0.1);">
                                    <div class="alert-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: #ff8800;">HIGH: Ransomware Campaign Active</h4>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary);">15 min ago</span>
                                    </div>
                                    <p style="margin: 0; color: var(--text-primary);">Ryuk variant targeting healthcare sector. Multiple infections reported.</p>
                                    <div class="alert-meta" style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-secondary);">
                                        <span>Severity: High</span> | <span>Confidence: 87%</span> | <span>Source: STIX/TAXII</span>
                                    </div>
                                </div>

                                <div class="alert-item medium" style="border-left: 4px solid #ffaa00; padding: 1rem; margin-bottom: 1rem; background: rgba(255, 170, 0, 0.1);">
                                    <div class="alert-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: #ffaa00;">MEDIUM: Phishing Campaign Detected</h4>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary);">1 hour ago</span>
                                    </div>
                                    <p style="margin: 0; color: var(--text-primary);">Credential harvesting campaign using COVID-19 themed emails.</p>
                                    <div class="alert-meta" style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-secondary);">
                                        <span>Severity: Medium</span> | <span>Confidence: 76%</span> | <span>Source: OpenIOC</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Remediation Section -->
                <div class="content-section" id="remediation">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-tools"></i> Automated Vulnerability Remediation
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-wrench"></i> Remediation Engine
                        </h3>

                        <div class="remediation-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="remediationTarget">Target System</label>
                                <select id="remediationTarget" class="input-field">
                                    <option value="all">All Systems</option>
                                    <option value="critical">Critical Systems Only</option>
                                    <option value="web-servers">Web Servers</option>
                                    <option value="databases">Databases</option>
                                    <option value="workstations">Workstations</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="remediationMode">Remediation Mode</label>
                                <select id="remediationMode" class="input-field">
                                    <option value="auto">Automatic</option>
                                    <option value="semi-auto">Semi-Automatic</option>
                                    <option value="manual">Manual Review</option>
                                    <option value="dry-run">Dry Run Only</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="patchSource">Patch Source</label>
                                <select id="patchSource" class="input-field">
                                    <option value="microsoft">Microsoft Update</option>
                                    <option value="redhat">Red Hat</option>
                                    <option value="ubuntu">Ubuntu</option>
                                    <option value="vendor">Vendor Repository</option>
                                    <option value="custom">Custom Repository</option>
                                </select>
                            </div>
                        </div>

                        <div class="remediation-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="startRemediation()">
                                <i class="fas fa-play"></i> Start Remediation
                            </button>
                            <button class="btn btn-secondary" onclick="scanForPatches()">
                                <i class="fas fa-search"></i> Scan for Patches
                            </button>
                            <button class="btn btn-warning" onclick="generateRemediationReport()">
                                <i class="fas fa-file"></i> Remediation Report
                            </button>
                            <button class="btn btn-info" onclick="rollbackChanges()">
                                <i class="fas fa-undo"></i> Rollback Changes
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-list-check"></i> Remediation Queue</h3>
                        </div>
                        <div class="results-content">
                            <div id="remediationQueue" class="remediation-queue">
                                <div class="remediation-item" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-secondary);">
                                    <div class="remediation-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: var(--primary-color);">CVE-2025-0001 - Apache HTTP Server</h4>
                                        <span class="remediation-status status-pending" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Pending</span>
                                    </div>
                                    <p style="margin: 0 0 0.5rem 0; color: var(--text-secondary); font-size: 0.9rem;">Zero-day vulnerability in mod_proxy. Remote code execution possible.</p>
                                    <div class="remediation-actions" style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-xs btn-success" onclick="applyPatch('CVE-2025-0001')">
                                            <i class="fas fa-check"></i> Apply
                                        </button>
                                        <button class="btn btn-xs btn-warning" onclick="schedulePatch('CVE-2025-0001')">
                                            <i class="fas fa-clock"></i> Schedule
                                        </button>
                                        <button class="btn btn-xs btn-info" onclick="viewPatchDetails('CVE-2025-0001')">
                                            <i class="fas fa-info"></i> Details
                                        </button>
                                    </div>
                                </div>

                                <div class="remediation-item" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-secondary);">
                                    <div class="remediation-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: var(--primary-color);">KB5034441 - Windows Server 2022</h4>
                                        <span class="remediation-status status-in-progress" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">In Progress</span>
                                    </div>
                                    <p style="margin: 0 0 0.5rem 0; color: var(--text-secondary); font-size: 0.9rem;">Security update for Windows kernel. Prevents privilege escalation.</p>
                                    <div class="remediation-progress" style="margin-top: 0.5rem;">
                                        <div class="progress-bar" style="width: 100%; height: 8px; background: var(--bg-primary); border-radius: 4px; overflow: hidden;">
                                            <div class="progress-fill" style="width: 65%; height: 100%; background: linear-gradient(90deg, var(--primary-color), var(--accent-color)); transition: width 0.3s ease;"></div>
                                        </div>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem; display: block;">65% complete - Installing on 13/20 systems</span>
                                    </div>
                                </div>

                                <div class="remediation-item" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-secondary);">
                                    <div class="remediation-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: var(--primary-color);">USN-1234-1 - Ubuntu 22.04 LTS</h4>
                                        <span class="remediation-status status-completed" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Completed</span>
                                    </div>
                                    <p style="margin: 0 0 0.5rem 0; color: var(--text-secondary); font-size: 0.9rem;">OpenSSL security update. Fixes multiple vulnerabilities.</p>
                                    <div class="remediation-meta" style="font-size: 0.8rem; color: var(--text-secondary);">
                                        <span>Completed: 2025-10-21 14:30</span> | <span>Systems: 25/25</span> | <span>Reboot Required: 3 systems</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Incident Response Section -->
                <div class="content-section" id="incident-response">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-shield-alt"></i> Incident Response Automation
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-sitemap"></i> Response Orchestration
                        </h3>

                        <div class="incident-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="incidentType">Incident Type</label>
                                <select id="incidentType" class="input-field">
                                    <option value="malware">Malware Infection</option>
                                    <option value="breach">Data Breach</option>
                                    <option value="ransomware">Ransomware</option>
                                    <option value="ddos">DDoS Attack</option>
                                    <option value="insider">Insider Threat</option>
                                    <option value="phishing">Phishing Campaign</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="responsePlaybook">Response Playbook</label>
                                <select id="responsePlaybook" class="input-field">
                                    <option value="nist">NIST SP 800-61</option>
                                    <option value="sans">SANS Incident Handling</option>
                                    <option value="custom">Custom Playbook</option>
                                    <option value="automated">Fully Automated</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="severityLevel">Severity Level</label>
                                <select id="severityLevel" class="input-field">
                                    <option value="critical">Critical</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                    <option value="low">Low</option>
                                    <option value="info">Informational</option>
                                </select>
                            </div>
                        </div>

                        <div class="incident-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-danger" onclick="activateIncidentResponse()">
                                <i class="fas fa-exclamation-triangle"></i> Activate Response
                            </button>
                            <button class="btn btn-primary" onclick="runContainment()">
                                <i class="fas fa-lock"></i> Containment Actions
                            </button>
                            <button class="btn btn-secondary" onclick="collectEvidence()">
                                <i class="fas fa-search"></i> Evidence Collection
                            </button>
                            <button class="btn btn-info" onclick="generateIRReport()">
                                <i class="fas fa-file"></i> Incident Report
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-clock"></i> Active Incident Timeline</h3>
                        </div>
                        <div class="results-content">
                            <div id="incidentTimeline" class="incident-timeline">
                                <div class="timeline-item" style="border-left: 4px solid #ff4444; padding: 1rem; margin-bottom: 1rem; background: rgba(255, 68, 68, 0.05); position: relative;">
                                    <div class="timeline-marker" style="position: absolute; left: -8px; top: 1rem; width: 12px; height: 12px; border-radius: 50%; background: #ff4444;"></div>
                                    <div class="timeline-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: #ff4444;">INCIDENT DETECTED</h4>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary);">2025-10-21 15:45:23</span>
                                    </div>
                                    <p style="margin: 0; color: var(--text-primary);">Ransomware infection detected on file server FS-01. Ryuk variant identified.</p>
                                    <div class="timeline-actions" style="margin-top: 0.5rem;">
                                        <span class="action-badge" style="background: #ff4444; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Isolation Initiated</span>
                                    </div>
                                </div>

                                <div class="timeline-item" style="border-left: 4px solid #ff8800; padding: 1rem; margin-bottom: 1rem; background: rgba(255, 136, 0, 0.05); position: relative;">
                                    <div class="timeline-marker" style="position: absolute; left: -8px; top: 1rem; width: 12px; height: 12px; border-radius: 50%; background: #ff8800;"></div>
                                    <div class="timeline-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: #ff8800;">CONTAINMENT PHASE</h4>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary);">2025-10-21 15:47:12</span>
                                    </div>
                                    <p style="margin: 0; color: var(--text-primary);">Network isolation completed. 15 affected systems quarantined. Backup verification initiated.</p>
                                    <div class="timeline-actions" style="margin-top: 0.5rem;">
                                        <span class="action-badge" style="background: #ff8800; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Evidence Collection</span>
                                        <span class="action-badge" style="background: #666; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Forensic Analysis</span>
                                    </div>
                                </div>

                                <div class="timeline-item" style="border-left: 4px solid #00cc66; padding: 1rem; margin-bottom: 1rem; background: rgba(0, 204, 102, 0.05); position: relative;">
                                    <div class="timeline-marker" style="position: absolute; left: -8px; top: 1rem; width: 12px; height: 12px; border-radius: 50%; background: #00cc66;"></div>
                                    <div class="timeline-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <h4 style="margin: 0; color: #00cc66;">RECOVERY INITIATED</h4>
                                        <span style="font-size: 0.8rem; color: var(--text-secondary);">2025-10-21 16:02:45</span>
                                    </div>
                                    <p style="margin: 0; color: var(--text-primary);">System restoration from clean backups completed. 12/15 systems recovered successfully.</p>
                                    <div class="timeline-actions" style="margin-top: 0.5rem;">
                                        <span class="action-badge" style="background: #00cc66; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Recovery Complete</span>
                                        <span class="action-badge" style="background: #0066cc; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Monitoring Active</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compliance Section -->
                <div class="content-section" id="compliance">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-clipboard-check"></i> Compliance Monitoring Dashboard
                    </h1>

                    <div class="compliance-overview" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                        <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary); grid-column: 1 / -1;">
                            <i class="fas fa-clipboard-check" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <h4>Compliance Monitoring Not Implemented</h4>
                            <p>Compliance monitoring and assessment features are not yet available.</p>
                            <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real compliance monitoring when implemented.</p>
                        </div>
                    </div>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-search"></i> Compliance Frameworks
                        </h3>

                        <div class="framework-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary); grid-column: 1 / -1;">
                                <i class="fas fa-clipboard-check" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                <h4>Compliance Frameworks Not Implemented</h4>
                                <p>Compliance framework assessments are not yet available.</p>
                                <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real compliance framework assessments when implemented.</p>
                            </div>
                        </div>

                        <div class="compliance-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="runAllAssessments()">
                                <i class="fas fa-play"></i> Run All Assessments
                            </button>
                            <button class="btn btn-secondary" onclick="generateComplianceReport()">
                                <i class="fas fa-file"></i> Compliance Report
                            </button>
                            <button class="btn btn-info" onclick="scheduleAssessments()">
                                <i class="fas fa-calendar"></i> Schedule Assessments
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-chart-bar"></i> Recent Assessment Results</h3>
                        </div>
                        <div class="results-content">
                            <div id="assessmentResults" class="assessment-results">
                                <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                    <i class="fas fa-clipboard-check" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                    <h4>Compliance Assessments Not Implemented</h4>
                                    <p>Compliance assessment and monitoring features are not yet available.</p>
                                    <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real compliance assessment results when implemented.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Traffic Analysis Section -->
                <div class="content-section" id="traffic-analysis">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-chart-line"></i> Network Traffic Analysis
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-network-wired"></i> Packet Capture & Analysis
                        </h3>

                        <div class="traffic-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="captureInterface">Capture Interface</label>
                                <select id="captureInterface" class="input-field">
                                    <option value="eth0">eth0 (192.168.1.100)</option>
                                    <option value="eth1">eth1 (10.0.0.100)</option>
                                    <option value="wlan0">wlan0 (WiFi)</option>
                                    <option value="any">All Interfaces</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="captureFilter">BPF Filter</label>
                                <input type="text" id="captureFilter" class="input-field" placeholder="e.g., tcp port 80 or host 192.168.1.1" value="tcp port 80 or tcp port 443">
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="captureDuration">Duration (seconds)</label>
                                <input type="number" id="captureDuration" class="input-field" value="60" min="10" max="3600">
                            </div>
                        </div>

                        <div class="traffic-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="startPacketCapture()">
                                <i class="fas fa-play"></i> Start Capture
                            </button>
                            <button class="btn btn-danger" onclick="stopPacketCapture()">
                                <i class="fas fa-stop"></i> Stop Capture
                            </button>
                            <button class="btn btn-secondary" onclick="analyzeTraffic()">
                                <i class="fas fa-search"></i> Analyze Traffic
                            </button>
                            <button class="btn btn-info" onclick="exportPCAP()">
                                <i class="fas fa-download"></i> Export PCAP
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-wave-square"></i> Live Traffic Stream</h3>
                        </div>
                        <div class="results-content">
                            <div id="trafficStream" class="traffic-stream">
                                <div class="traffic-packet" style="border: 1px solid var(--border-color); border-radius: 4px; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-secondary); font-family: 'Courier New', monospace; font-size: 0.8rem;">
                                    <span style="color: #00cc66;">15:47:23</span> <span style="color: #0066cc;">192.168.1.100:443</span>  <span style="color: #ff8800;">203.0.113.1:56789</span> <span style="color: #ff4444;">[TLS]</span> 1,482 bytes
                                </div>
                                <div class="traffic-packet" style="border: 1px solid var(--border-color); border-radius: 4px; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-secondary); font-family: 'Courier New', monospace; font-size: 0.8rem;">
                                    <span style="color: #00cc66;">15:47:22</span> <span style="color: #0066cc;">10.0.0.50:80</span>  <span style="color: #ff8800;">192.168.1.100:49876</span> <span style="color: #666;">[HTTP]</span> 312 bytes
                                </div>
                                <div class="traffic-packet" style="border: 1px solid var(--border-color); border-radius: 4px; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-secondary); font-family: 'Courier New', monospace; font-size: 0.8rem;">
                                    <span style="color: #00cc66;">15:47:21</span> <span style="color: #0066cc;">192.168.1.100:53</span>  <span style="color: #ff8800;">8.8.8.8:53</span> <span style="color: #00cc66;">[DNS]</span> 78 bytes
                                </div>
                                <div class="traffic-packet anomaly" style="border: 1px solid #ff4444; border-radius: 4px; padding: 0.5rem; margin-bottom: 0.5rem; background: rgba(255, 68, 68, 0.1); font-family: 'Courier New', monospace; font-size: 0.8rem;">
                                    <span style="color: #ff4444;">15:47:20</span> <span style="color: #0066cc;">192.168.1.100:22</span>  <span style="color: #ff8800;">45.67.89.123:22</span> <span style="color: #ff4444;">[SSH] ANOMALY DETECTED</span> 2,134 bytes
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-chart-pie"></i> Traffic Analysis Summary</h3>
                        </div>
                        <div class="results-content">
                            <div class="traffic-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div class="stat-value" style="font-size: 2rem; font-weight: bold; color: var(--primary-color);">1,247</div>
                                    <div class="stat-label" style="color: var(--text-secondary);">Packets Captured</div>
                                </div>
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div class="stat-value" style="font-size: 2rem; font-weight: bold; color: #00cc66;">89%</div>
                                    <div class="stat-label" style="color: var(--text-secondary);">HTTPS Traffic</div>
                                </div>
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div class="stat-value" style="font-size: 2rem; font-weight: bold; color: #ff8800;">3</div>
                                    <div class="stat-label" style="color: var(--text-secondary);">Anomalies Detected</div>
                                </div>
                                <div class="stat-item" style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div class="stat-value" style="font-size: 2rem; font-weight: bold; color: #ff4444;">156</div>
                                    <div class="stat-label" style="color: var(--text-secondary);">KB/s Throughput</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Malware Sandbox Section -->
                <div class="content-section" id="malware-sandbox">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-virus"></i> Malware Analysis Sandbox
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-flask"></i> Behavioral Analysis Engine
                        </h3>

                        <div class="sandbox-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="sampleSource">Sample Source</label>
                                <select id="sampleSource" class="input-field">
                                    <option value="upload">File Upload</option>
                                    <option value="url">URL Download</option>
                                    <option value="hash">Hash Lookup</option>
                                    <option value="email">Email Attachment</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="analysisDepth">Analysis Depth</label>
                                <select id="analysisDepth" class="input-field">
                                    <option value="static">Static Analysis Only</option>
                                    <option value="dynamic">Dynamic Analysis</option>
                                    <option value="full">Full Analysis</option>
                                    <option value="memory">Memory Forensics</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="sandboxOS">Sandbox OS</label>
                                <select id="sandboxOS" class="input-field">
                                    <option value="windows10">Windows 10</option>
                                    <option value="windows11">Windows 11</option>
                                    <option value="ubuntu">Ubuntu 22.04</option>
                                    <option value="macos">macOS Ventura</option>
                                </select>
                            </div>
                        </div>

                        <div class="file-upload" style="border: 2px dashed var(--border-color); border-radius: 8px; padding: 2rem; text-align: center; margin-bottom: 2rem; background: var(--bg-secondary);">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 1rem;"></i>
                            <p style="margin: 0 0 1rem 0; color: var(--text-secondary);">Drag and drop malware sample here or click to browse</p>
                            <input type="file" id="malwareSample" style="display: none;" accept=".exe,.dll,.bat,.ps1,.vbs,.js,.jar,.doc,.docx,.pdf,.zip,.rar">
                            <button class="btn btn-primary" onclick="document.getElementById('malwareSample').click()">
                                <i class="fas fa-folder-open"></i> Select File
                            </button>
                        </div>

                        <div class="sandbox-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-danger" onclick="startAnalysis()">
                                <i class="fas fa-play"></i> Start Analysis
                            </button>
                            <button class="btn btn-secondary" onclick="generateYARARule()">
                                <i class="fas fa-code"></i> Generate YARA Rule
                            </button>
                            <button class="btn btn-info" onclick="submitToVirusTotal()">
                                <i class="fas fa-external-link-alt"></i> Submit to VT
                            </button>
                            <button class="btn btn-warning" onclick="exportAnalysis()">
                                <i class="fas fa-download"></i> Export Report
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-microscope"></i> Analysis Results</h3>
                        </div>
                        <div class="results-content">
                            <div id="analysisResults" class="analysis-results">
                                <div class="analysis-section" style="margin-bottom: 2rem;">
                                    <h4 style="color: var(--primary-color); margin-bottom: 1rem;">Static Analysis</h4>
                                    <div class="analysis-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                        <div class="analysis-item" style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div class="item-label" style="font-weight: bold; color: var(--primary-color);">File Type</div>
                                            <div class="item-value">PE32 executable (GUI)</div>
                                        </div>
                                        <div class="analysis-item" style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div class="item-label" style="font-weight: bold; color: var(--primary-color);">File Size</div>
                                            <div class="item-value">245 KB</div>
                                        </div>
                                        <div class="analysis-item" style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div class="item-label" style="font-weight: bold; color: var(--primary-color);">MD5 Hash</div>
                                            <div class="item-value" style="font-family: 'Courier New', monospace; font-size: 0.8rem;">a1b2c3d4e5f678901234567890</div>
                                        </div>
                                        <div class="analysis-item" style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                            <div class="item-label" style="font-weight: bold; color: var(--primary-color);">Entropy</div>
                                            <div class="item-value">7.23 (High)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="analysis-section" style="margin-bottom: 2rem;">
                                    <h4 style="color: var(--primary-color); margin-bottom: 1rem;">Behavioral Analysis</h4>
                                    <div class="behavior-log">
                                        <div class="behavior-item" style="border-left: 4px solid #ff4444; padding: 0.5rem; margin-bottom: 0.5rem; background: rgba(255, 68, 68, 0.05);">
                                            <span style="font-weight: bold; color: #ff4444;">MALICIOUS</span> - Created registry key: HKCU\Software\Microsoft\Windows\CurrentVersion\Run
                                        </div>
                                        <div class="behavior-item" style="border-left: 4px solid #ff8800; padding: 0.5rem; margin-bottom: 0.5rem; background: rgba(255, 136, 0, 0.05);">
                                            <span style="font-weight: bold; color: #ff8800;">SUSPICIOUS</span> - Network connection to C2 server: 185.234.123.45:443
                                        </div>
                                        <div class="behavior-item" style="border-left: 4px solid #ff4444; padding: 0.5rem; margin-bottom: 0.5rem; background: rgba(255, 68, 68, 0.05);">
                                            <span style="font-weight: bold; color: #ff4444;">MALICIOUS</span> - Modified system files in C:\Windows\System32
                                        </div>
                                        <div class="behavior-item" style="border-left: 4px solid #00cc66; padding: 0.5rem; margin-bottom: 0.5rem; background: rgba(0, 204, 102, 0.05);">
                                            <span style="font-weight: bold; color: #00cc66;">INFO</span> - Process injection detected (PID: 1234  PID: 5678)
                                        </div>
                                    </div>
                                </div>

                                <div class="analysis-section">
                                    <h4 style="color: var(--primary-color); margin-bottom: 1rem;">Detection Results</h4>
                                    <div class="detection-results" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                                        <div class="detection-item" style="text-align: center; padding: 1rem; background: rgba(255, 68, 68, 0.1); border-radius: 8px; border: 1px solid #ff4444;">
                                            <div class="detection-engine">VirusTotal</div>
                                            <div class="detection-ratio" style="font-size: 1.5rem; font-weight: bold; color: #ff4444;">54/72</div>
                                            <div class="detection-label" style="font-size: 0.8rem; color: var(--text-secondary);">engines detected</div>
                                        </div>
                                        <div class="detection-item" style="text-align: center; padding: 1rem; background: rgba(255, 136, 0, 0.1); border-radius: 8px; border: 1px solid #ff8800;">
                                            <div class="detection-engine">YARA Rules</div>
                                            <div class="detection-ratio" style="font-size: 1.5rem; font-weight: bold; color: #ff8800;">3</div>
                                            <div class="detection-label" style="font-size: 0.8rem; color: var(--text-secondary);">rules matched</div>
                                        </div>
                                        <div class="detection-item" style="text-align: center; padding: 1rem; background: rgba(0, 204, 102, 0.1); border-radius: 8px; border: 1px solid #00cc66;">
                                            <div class="detection-engine">Sandbox Score</div>
                                            <div class="detection-ratio" style="font-size: 1.5rem; font-weight: bold; color: #00cc66;">9.2/10</div>
                                            <div class="detection-label" style="font-size: 0.8rem; color: var(--text-secondary);">malicious score</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Collaboration Section -->
                <div class="content-section" id="collaboration">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-users"></i> Security Collaboration Hub
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-user-shield"></i> Team Management & RBAC
                        </h3>

                        <div class="collaboration-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="teamRole">Team Role</label>
                                <select id="teamRole" class="input-field">
                                    <option value="admin">Security Administrator</option>
                                    <option value="analyst">Security Analyst</option>
                                    <option value="auditor">Compliance Auditor</option>
                                    <option value="operator">SOC Operator</option>
                                    <option value="viewer">Read-Only Viewer</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="workspaceType">Workspace Type</label>
                                <select id="workspaceType" class="input-field">
                                    <option value="incident">Incident Response</option>
                                    <option value="assessment">Security Assessment</option>
                                    <option value="compliance">Compliance Audit</option>
                                    <option value="threat-hunt">Threat Hunting</option>
                                    <option value="forensics">Digital Forensics</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="accessLevel">Access Level</label>
                                <select id="accessLevel" class="input-field">
                                    <option value="confidential">Confidential</option>
                                    <option value="restricted">Restricted</option>
                                    <option value="internal">Internal Use</option>
                                    <option value="public">Public Access</option>
                                </select>
                            </div>
                        </div>

                        <div class="collaboration-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="createSharedWorkspace()">
                                <i class="fas fa-plus"></i> Create Workspace
                            </button>
                            <button class="btn btn-secondary" onclick="inviteTeamMember()">
                                <i class="fas fa-user-plus"></i> Invite Member
                            </button>
                            <button class="btn btn-info" onclick="startCollaborationSession()">
                                <i class="fas fa-video"></i> Live Session
                            </button>
                            <button class="btn btn-warning" onclick="exportCollaborationReport()">
                                <i class="fas fa-file-export"></i> Export Report
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-comments"></i> Active Collaborations</h3>
                        </div>
                        <div class="results-content">
                            <div id="collaborationSessions" class="collaboration-sessions">
                                <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                    <i class="fas fa-users" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                    <h4>No Active Collaborations</h4>
                                    <p>Collaboration features are not yet implemented.</p>
                                    <p style="font-size: 0.9rem; margin-top: 1rem;">This section will show real-time collaboration sessions when the feature is available.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cloud Security Section -->
                <div class="content-section" id="cloud-security">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-cloud"></i> Cloud Security Posture Management
                    </h1>

                    <div class="cloud-overview" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                        <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary); grid-column: 1 / -1;">
                            <i class="fas fa-cloud" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <h4>Cloud Security Not Implemented</h4>
                            <p>Cloud security posture management features are not yet available.</p>
                            <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real cloud security assessments when implemented.</p>
                        </div>
                    </div>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-server"></i> Cloud Provider Management
                        </h3>

                        <div class="cloud-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="cloudProvider">Cloud Provider</label>
                                <select id="cloudProvider" class="input-field">
                                    <option value="aws">Amazon Web Services</option>
                                    <option value="azure">Microsoft Azure</option>
                                    <option value="gcp">Google Cloud Platform</option>
                                    <option value="oracle">Oracle Cloud</option>
                                    <option value="ibm">IBM Cloud</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="assessmentScope">Assessment Scope</label>
                                <select id="assessmentScope" class="input-field">
                                    <option value="full">Full Infrastructure</option>
                                    <option value="iam">IAM & Access</option>
                                    <option value="networking">Networking & Security Groups</option>
                                    <option value="storage">Storage & Data</option>
                                    <option value="compute">Compute Resources</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="complianceFramework">Compliance Framework</label>
                                <select id="complianceFramework" class="input-field">
                                    <option value="cis">CIS Benchmarks</option>
                                    <option value="nist">NIST CSF</option>
                                    <option value="iso27001">ISO 27001</option>
                                    <option value="soc2">SOC 2</option>
                                    <option value="pci-dss">PCI-DSS</option>
                                </select>
                            </div>
                        </div>

                        <div class="cloud-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="runCloudAssessment()">
                                <i class="fas fa-search"></i> Run Assessment
                            </button>
                            <button class="btn btn-secondary" onclick="scanDriftDetection()">
                                <i class="fas fa-random"></i> Drift Detection
                            </button>
                            <button class="btn btn-warning" onclick="generateCloudReport()">
                                <i class="fas fa-file-alt"></i> Security Report
                            </button>
                            <button class="btn btn-info" onclick="autoRemediate()">
                                <i class="fas fa-wrench"></i> Auto-Remediate
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-exclamation-triangle"></i> Cloud Security Findings</h3>
                        </div>
                        <div class="results-content">
                            <div id="cloudFindings" class="cloud-findings">
                                <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                    <i class="fas fa-cloud" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                    <h4>Cloud Security Not Implemented</h4>
                                    <p>Cloud security posture management features are not yet available.</p>
                                    <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real cloud security assessments when implemented.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Auto Pentest Section -->
                <div class="content-section" id="auto-pentest">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-crosshairs"></i> Automated Penetration Testing
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-robot"></i> Automated Testing Engine
                        </h3>

                        <div class="pentest-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="pentestTarget">Target Scope</label>
                                <select id="pentestTarget" class="input-field">
                                    <option value="web-app">Web Application</option>
                                    <option value="api">API Endpoints</option>
                                    <option value="network">Network Infrastructure</option>
                                    <option value="mobile">Mobile Application</option>
                                    <option value="cloud">Cloud Environment</option>
                                    <option value="iot">IoT Devices</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="pentestIntensity">Testing Intensity</label>
                                <select id="pentestIntensity" class="input-field">
                                    <option value="passive">Passive Reconnaissance</option>
                                    <option value="safe">Safe Scanning</option>
                                    <option value="normal">Normal Testing</option>
                                    <option value="aggressive">Aggressive Testing</option>
                                    <option value="insane">Insane Testing</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="pentestSchedule">Schedule Type</label>
                                <select id="pentestSchedule" class="input-field">
                                    <option value="manual">Manual Execution</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                </select>
                            </div>
                        </div>

                        <div class="pentest-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-danger" onclick="startPentest()">
                                <i class="fas fa-play"></i> Start Penetration Test
                            </button>
                            <button class="btn btn-secondary" onclick="runReconScan()">
                                <i class="fas fa-search"></i> Reconnaissance
                            </button>
                            <button class="btn btn-warning" onclick="exploitVulnerabilities()">
                                <i class="fas fa-bomb"></i> Exploit Phase
                            </button>
                            <button class="btn btn-info" onclick="generatePentestReport()">
                                <i class="fas fa-file-alt"></i> Executive Report
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-chart-bar"></i> Penetration Test Results</h3>
                        </div>
                        <div class="results-content">
                            <div id="pentestResults" class="pentest-results">
                                <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                    <i class="fas fa-crosshairs" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                    <h4>Automated Penetration Testing Not Implemented</h4>
                                    <p>Automated penetration testing features are not yet available.</p>
                                    <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real automated penetration test results when implemented.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Backup & Recovery Section -->
                <div class="content-section" id="backup-recovery">
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-shield-alt"></i> Backup & Recovery Testing
                    </h1>

                    <div class="backup-overview" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                        <div class="backup-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; text-align: center;">
                            <div class="backup-score" style="font-size: 3rem; font-weight: bold; color: #00cc66; margin-bottom: 0.5rem;">98%</div>
                            <div class="backup-label" style="color: var(--text-secondary);">Backup Success Rate</div>
                            <div class="backup-trend" style="margin-top: 0.5rem; font-size: 0.9rem; color: #00cc66;">
                                <i class="fas fa-arrow-up"></i> +1.2% from last month
                            </div>
                        </div>

                        <div class="backup-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; text-align: center;">
                            <div class="backup-score" style="font-size: 3rem; font-weight: bold; color: #0066cc; margin-bottom: 0.5rem;">2.4h</div>
                            <div class="backup-label" style="color: var(--text-secondary);">Average RTO</div>
                            <div class="backup-trend" style="margin-top: 0.5rem; font-size: 0.9rem; color: #00cc66;">
                                <i class="fas fa-arrow-down"></i> -0.3h from target
                            </div>
                        </div>

                        <div class="backup-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; text-align: center;">
                            <div class="backup-score" style="font-size: 3rem; font-weight: bold; color: #ff8800; margin-bottom: 0.5rem;">15</div>
                            <div class="backup-label" style="color: var(--text-secondary);">Failed Tests</div>
                            <div class="backup-trend" style="margin-top: 0.5rem; font-size: 0.9rem; color: #ff4444;">
                                <i class="fas fa-arrow-up"></i> +2 from last test
                            </div>
                        </div>
                    </div>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-database"></i> Recovery Testing Suite
                        </h3>

                        <div class="backup-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="input-group">
                                <label class="input-label" for="backupType">Backup Type</label>
                                <select id="backupType" class="input-field">
                                    <option value="full">Full Backup</option>
                                    <option value="incremental">Incremental</option>
                                    <option value="differential">Differential</option>
                                    <option value="snapshot">Snapshot</option>
                                    <option value="cloud">Cloud Backup</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="testScenario">Test Scenario</label>
                                <select id="testScenario" class="input-field">
                                    <option value="disaster">Disaster Recovery</option>
                                    <option value="corruption">Data Corruption</option>
                                    <option value="ransomware">Ransomware Attack</option>
                                    <option value="hardware">Hardware Failure</option>
                                    <option value="cyber">Cyber Attack</option>
                                </select>
                            </div>

                            <div class="input-group">
                                <label class="input-label" for="recoveryScope">Recovery Scope</label>
                                <select id="recoveryScope" class="input-field">
                                    <option value="single">Single System</option>
                                    <option value="department">Department</option>
                                    <option value="site">Site Recovery</option>
                                    <option value="full">Full Organization</option>
                                    <option value="cloud">Cloud Failover</option>
                                </select>
                            </div>
                        </div>

                        <div class="backup-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="runBackupTest()">
                                <i class="fas fa-play"></i> Run Recovery Test
                            </button>
                            <button class="btn btn-secondary" onclick="verifyBackupIntegrity()">
                                <i class="fas fa-check-circle"></i> Integrity Check
                            </button>
                            <button class="btn btn-warning" onclick="simulateDisaster()">
                                <i class="fas fa-exclamation-triangle"></i> Disaster Simulation
                            </button>
                            <button class="btn btn-info" onclick="generateDRReport()">
                                <i class="fas fa-file-alt"></i> DR Report
                            </button>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-history"></i> Recent Recovery Tests</h3>
                        </div>
                        <div class="results-content">
                            <div id="recoveryTests" class="recovery-tests">
                                <div class="empty-state" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                    <i class="fas fa-shield-alt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                    <h4>Backup & Recovery Testing Not Implemented</h4>
                                    <p>Automated backup and disaster recovery testing features are not yet available.</p>
                                    <p style="font-size: 0.9rem; margin-top: 1rem;">This section will provide real backup recovery test results when implemented.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                    <h1 style="margin-bottom: 2rem; font-family: 'Orbitron', monospace; font-size: 2.5rem; color: var(--primary-color);">
                        <i class="fas fa-cog"></i> Configuration
                    </h1>

                    <div class="scan-interface">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-key"></i> API Configuration
                        </h3>
                        <div id="apiConfigSection" class="input-group" style="margin-bottom: 2rem;">
                            <label class="input-label" for="openaiKey">OpenAI API Key</label>
                            <input type="password" id="openaiKey" class="input-field"
                                   placeholder="sk-..."
                                   value="">
                            <button class="btn btn-primary" onclick="saveSettings()" style="margin-top: 1rem;">
                                <i class="fas fa-save"></i> Save Settings
                            </button>
                        </div>
                        <div id="apiConfiguredSection" class="input-group" style="margin-bottom: 2rem; display: none;">
                            <div style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color);">
                                <i class="fas fa-check-circle" style="color: #00cc66; font-size: 2rem; margin-bottom: 0.5rem;"></i>
                                <h4 style="color: var(--primary-color); margin: 0 0 0.5rem 0;">API Credentials Configured</h4>
                                <p style="color: var(--text-secondary); margin: 0 0 1rem 0; font-size: 0.9rem;">
                                    OpenAI API key is configured and ready to use.
                                </p>
                                <button class="btn btn-secondary" onclick="reconfigureAPI()">
                                    <i class="fas fa-cog"></i> Reconfigure API
                                </button>
                            </div>
                        </div>

                        <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                            <i class="fas fa-sliders-h"></i> Scanner Settings
                        </h3>
                        <div class="scan-controls">
                            <div class="input-group">
                                <label class="input-label" for="scanTimeout">Scan Timeout (seconds)</label>
                                <input type="number" id="scanTimeout" class="input-field" value="30">
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="maxThreads">Max Threads</label>
                                <input type="number" id="maxThreads" class="input-field" value="10">
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="apiPort">API Server Port</label>
                                <input type="number" id="apiPort" class="input-field" value="8000">
                            </div>
                        </div>
                    </div>

                    <div class="results-container">
                        <div class="results-header">
                            <h3><i class="fas fa-info-circle"></i> System Information</h3>
                        </div>
                        <div class="results-content">
                            <div class="terminal-output" id="systemInfo">
CyberSentinel Pro v1.0.0
Platform: Web Interface
Scanner Engine: Python 3.x
AI Engine: OpenAI GPT Integration
Status: All systems operational
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Initialize particles background
        function createParticles() {
            const particles = document.getElementById('particles');
            const particleCount = 50;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particles.appendChild(particle);
            }
        }

        // Navigation handling
        function initNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.content-section');

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();

                    // Remove active class from all links and sections
                    navLinks.forEach(l => l.classList.remove('active'));
                    sections.forEach(s => s.classList.remove('active'));

                    // Add active class to clicked link
                    link.classList.add('active');

                    // Show corresponding section
                    const targetSection = document.getElementById(link.dataset.section);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                });
            });
        }

        // Quantum state containers
        const quantumState = {
            value: 37,
            baseline: 37,
            history: []
        };

        let lastNetworkResults = null;
        let lastWebResults = null;

        const memeticBlueprints = {
            baseline: [
                { name: 'Vendor Drift', detail: 'Change velocity nominal, cadence stable.' },
                { name: 'Credential Echo', detail: 'No leakage resonance detected.' },
                { name: 'Logistics Pulse', detail: 'Freight telemetry within tolerance.' }
            ],
            collusion: [
                { name: 'Syndicate Whisper', detail: 'Partner telemetry reveals synchronized invoice timing.' },
                { name: 'Mirror Account', detail: 'Detected shared credential fingerprint across vendors.' },
                { name: 'Quiet Ledger', detail: 'Unusual silence from compliance node network.' }
            ],
            disruption: [
                { name: 'Sabotage Meme', detail: 'Narrative spikes around firmware downgrade campaigns.' },
                { name: 'Cascade Event', detail: 'Workflow automation jitter rises 18% in 4 hours.' },
                { name: 'Proxy Surge', detail: 'Foreign relay nodes simulate supplier IP ranges.' }
            ],
            espionage: [
                { name: 'Specter Thread', detail: 'Stealth document access by low-noise identity cluster.' },
                { name: 'Phantom Freight', detail: 'Logistics sensor spoofing attempts traced to unknown ASN.' },
                { name: 'Quiet Harvest', detail: 'Slow exfil pattern disguised as telemetry heartbeat.' }
            ]
        };

        // API communication
        const API_BASE_URL = 'http://localhost:8000';

        async function apiRequest(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API request failed:', error);
                addLogEntry(`[ERROR] API request failed: ${error.message}`, 'error');
                return null;
            }
        }

        // Network scanning
        async function startNetworkScan() {
            const target = document.getElementById('networkTarget').value.trim();
            const scanType = document.getElementById('scanType').value;

            if (!target) {
                alert('Please enter a target to scan');
                return;
            }

            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div> Scanning...';
            button.disabled = true;

            // Show progress bar
            const progressBar = document.getElementById('networkProgress');
            const progressFill = document.getElementById('networkProgressFill');
            progressBar.style.display = 'block';

            // Simulate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 90) progress = 90;
                progressFill.style.width = progress + '%';
            }, 500);

            addLogEntry(`[NETWORK] Starting ${scanType} scan of ${target}`);
            updateScanStatus('scanning');

            try {
                const result = await apiRequest('/scan/network', {
                    method: 'POST',
                    body: JSON.stringify({
                        target: target,
                        scan_type: scanType
                    })
                });

                clearInterval(progressInterval);
                progressFill.style.width = '100%';

                if (result && result.task_id) {
                    // Poll for results
                    pollScanResults(result.task_id, 'network');
                } else {
                    addLogEntry('[ERROR] Network scan failed - no task ID returned');
                    progressBar.style.display = 'none';
                    updateScanStatus('offline');
                }

            } catch (error) {
                clearInterval(progressInterval);
                addLogEntry(`[ERROR] Network scan failed: ${error.message}`, 'error');
                progressBar.style.display = 'none';
                updateScanStatus('offline');
            }

            button.innerHTML = originalText;
            button.disabled = false;
        }

        // Web scanning
        async function startWebScan() {
            const target = document.getElementById('webTarget').value.trim();
            const scanType = document.getElementById('webScanType').value;

            if (!target) {
                alert('Please enter a target URL to scan');
                return;
            }

            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div> Scanning...';
            button.disabled = true;

            // Show progress bar
            const progressBar = document.getElementById('webProgress');
            const progressFill = document.getElementById('webProgressFill');
            progressBar.style.display = 'block';

            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 8;
                if (progress > 85) progress = 85;
                progressFill.style.width = progress + '%';
            }, 800);

            addLogEntry(`[WEB] Starting ${scanType} vulnerability scan of ${target}`);
            updateScanStatus('scanning');

            try {
                const result = await apiRequest('/scan/web', {
                    method: 'POST',
                    body: JSON.stringify({
                        target: target,
                        scan_type: scanType
                    })
                });

                clearInterval(progressInterval);
                progressFill.style.width = '100%';

                if (result && result.task_id) {
                    // Poll for results
                    pollScanResults(result.task_id, 'web');
                } else {
                    addLogEntry('[ERROR] Web scan failed - no task ID returned');
                    progressBar.style.display = 'none';
                    updateScanStatus('offline');
                }

            } catch (error) {
                clearInterval(progressInterval);
                addLogEntry(`[ERROR] Web scan failed: ${error.message}`, 'error');
                progressBar.style.display = 'none';
                updateScanStatus('offline');
            }

            button.innerHTML = originalText;
            button.disabled = false;
        }

        // AI Analysis
        async function startAIAnalysis() {
            const inputType = document.getElementById('aiInputType').value;
            const model = document.getElementById('aiModel').value;

            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div> Analyzing...';
            button.disabled = true;

            addLogEntry(`[AI] Preparing ${model} analysis (${inputType} mode)`);

            let scanData = null;
            let datasetLabel = 'scan';

            if (inputType === 'latest') {
                if (!lastNetworkResults && !lastWebResults) {
                    alert('Run at least one network or web scan before requesting AI analysis.');
                    button.innerHTML = originalText;
                    button.disabled = false;
                    addLogEntry('[AI] Analysis aborted - no scan data available');
                    return;
                }

                const preferredResults = lastWebResults || lastNetworkResults;
                datasetLabel = lastWebResults ? 'web scan' : 'network scan';

                try {
                    scanData = JSON.parse(JSON.stringify(preferredResults || {}));
                } catch (serializationError) {
                    console.error('Failed to prepare scan data for AI analysis:', serializationError);
                    scanData = preferredResults || {};
                }

                scanData.metadata = {
                    ...(scanData.metadata || {}),
                    ai_request: {
                        source: 'latest',
                        selected_dataset: datasetLabel,
                        model: model,
                        generated_at: new Date().toISOString()
                    }
                };

                addLogEntry(`[AI] Using ${datasetLabel} results for analysis`);
            } else {
                alert('Only "Latest Scan Results" analysis is currently supported.');
                button.innerHTML = originalText;
                button.disabled = false;
                addLogEntry('[AI] Analysis aborted - unsupported input mode requested');
                return;
            }

            try {
                const result = await apiRequest('/ai/analyze', {
                    method: 'POST',
                    body: JSON.stringify({
                        scan_data: scanData
                    })
                });

                if (result) {
                    displayAIResults(result);
                } else {
                    addLogEntry('[ERROR] AI analysis failed - no results returned');
                }

            } catch (error) {
                addLogEntry(`[ERROR] AI analysis failed: ${error.message}`, 'error');
            }

            button.innerHTML = originalText;
            button.disabled = false;
        }

        // Results display functions
        function displayNetworkResults(results) {
            lastNetworkResults = results;
            const resultsDiv = document.getElementById('networkResults');
            let output = `[NETWORK SCAN COMPLETE]\n\n`;

            if (results.hosts && results.hosts.length > 0) {
                results.hosts.forEach((host, index) => {
                    output += ` Host ${index + 1}: ${host.ip}\n`;
                    if (host.ports && host.ports.length > 0) {
                        output += ` Open Ports:\n`;
                        host.ports.forEach(port => {
                            const status = port.state === 'open' ? '' : '';
                            output += `   ${status} ${port.port}/${port.protocol} - ${port.service || 'unknown'}\n`;
                        });
                    }
                    output += `\n`;
                });

                // Update dashboard stats
                document.getElementById('hostsScanned').textContent = results.hosts.length;
                document.getElementById('lastScanTime').textContent = new Date().toLocaleTimeString();

                addLogEntry(`[NETWORK] Scan complete - Found ${results.hosts.length} hosts`);
            } else {
                output += `No hosts found or scan failed.\n`;
            }

            resultsDiv.textContent = output;
            document.getElementById('exportNetworkBtn').style.display = 'block';
        }

        function displayWebResults(results) {
            lastWebResults = results;
            const resultsDiv = document.getElementById('webResults');
            let output = `[WEB VULNERABILITY SCAN COMPLETE]\n\n`;
            output += ` Target: ${results.url || 'Unknown'}\n`;
            output += ` Scan Time: ${new Date(results.scan_time || Date.now()).toLocaleString()}\n\n`;

            if (results.vulnerabilities && results.vulnerabilities.length > 0) {
                output += ` VULNERABILITIES FOUND:\n\n`;

                let criticalCount = 0;
                results.vulnerabilities.forEach((vuln, index) => {
                    const severityIcon = {
                        'Critical': '',
                        'High': '',
                        'Medium': '',
                        'Low': '',
                        'Info': ''
                    };

                    if (vuln.severity === 'Critical') criticalCount++;

                    output += `${index + 1}. ${severityIcon[vuln.severity] || ''} ${vuln.type}\n`;
                    output += `   Severity: ${vuln.severity}\n`;
                    output += `   Description: ${vuln.description}\n\n`;
                });

                // Update dashboard stats
                document.getElementById('vulnerabilities').textContent = results.vulnerabilities.length;
                document.getElementById('criticalIssues').textContent = criticalCount;
                document.getElementById('lastScanTime').textContent = new Date().toLocaleTimeString();

                addLogEntry(`[WEB] Scan complete - Found ${results.vulnerabilities.length} vulnerabilities`);
            } else {
                output += ` No vulnerabilities found!\n`;
                addLogEntry('[WEB] Scan complete - No vulnerabilities detected');
            }

            resultsDiv.textContent = output;
            document.getElementById('exportWebBtn').style.display = 'block';
        }

        function displayAIResults(results) {
            const resultsDiv = document.getElementById('aiResults');
            // Clear the status messages and show results
            document.getElementById('aiConfigMessage').style.display = 'none';
            document.getElementById('aiReadyMessage').style.display = 'none';
            resultsDiv.textContent = results.analysis || 'AI analysis completed successfully.';
            addLogEntry('[AI] Analysis complete - Results displayed');
        }

        // Utility functions
        function addLogEntry(message, type = 'info') {
            const activityLog = document.getElementById('activityLog');
            const timestamp = new Date().toLocaleTimeString();
            const logLine = `[${timestamp}] ${message}\n`;

            activityLog.textContent += logLine;
            activityLog.scrollTop = activityLog.scrollHeight;
        }

        function updateScanStatus(status) {
            const scanStatus = document.getElementById('scanStatus');
            scanStatus.className = `status-dot status-${status}`;
        }

        async function pollScanResults(taskId, scanType) {
            const maxAttempts = 60; // 5 minutes max (60 * 5 seconds)
            let attempts = 0;

            const pollInterval = setInterval(async () => {
                attempts++;

                try {
                    const response = await apiRequest(`/scan/status/${taskId}`);
                    if (response && response.status === 'completed') {
                        clearInterval(pollInterval);

                        const resultPayload = response.result || response.results;
                        if (resultPayload) {
                            if (scanType === 'network') {
                                displayNetworkResults(resultPayload);
                            } else if (scanType === 'web') {
                                displayWebResults(resultPayload);
                            }
                        } else {
                            addLogEntry(`[${scanType.toUpperCase()}] Scan completed but no results returned`);
                        }

                        const progressBar = document.getElementById(scanType === 'network' ? 'networkProgress' : 'webProgress');
                        if (progressBar) {
                            progressBar.style.display = 'none';
                            const fill = progressBar.querySelector('.progress-fill');
                            if (fill) fill.style.width = '0%';
                        }
                        updateScanStatus('offline');

                    } else if (response && response.status === 'failed') {
                        clearInterval(pollInterval);
                        addLogEntry(`[${scanType.toUpperCase()}] Scan failed: ${response.error || 'Unknown error'}`);
                        const progressBar = document.getElementById(scanType === 'network' ? 'networkProgress' : 'webProgress');
                        if (progressBar) {
                            progressBar.style.display = 'none';
                            const fill = progressBar.querySelector('.progress-fill');
                            if (fill) fill.style.width = '0%';
                        }
                        updateScanStatus('offline');

                    } else if (attempts >= maxAttempts) {
                        clearInterval(pollInterval);
                        addLogEntry(`[${scanType.toUpperCase()}] Scan timed out after 5 minutes`);
                        const progressBar = document.getElementById(scanType === 'network' ? 'networkProgress' : 'webProgress');
                        if (progressBar) {
                            progressBar.style.display = 'none';
                            const fill = progressBar.querySelector('.progress-fill');
                            if (fill) fill.style.width = '0%';
                        }
                        updateScanStatus('offline');
                    }
                } catch (error) {
                    clearInterval(pollInterval);
                    addLogEntry(`[${scanType.toUpperCase()}] Error polling scan status: ${error.message}`);
                    const progressBar = document.getElementById(scanType === 'network' ? 'networkProgress' : 'webProgress');
                    if (progressBar) {
                        progressBar.style.display = 'none';
                        const fill = progressBar.querySelector('.progress-fill');
                        if (fill) fill.style.width = '0%';
                    }
                    updateScanStatus('offline');
                }
            }, 5000); // Poll every 5 seconds
        }

        function exportResults(type) {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const filename = `cybersentinel-${type}-scan-${timestamp}.json`;

            let data = {};
            if (type === 'network') {
                data = {
                    scan_type: 'network',
                    timestamp: new Date().toISOString(),
                    results: document.getElementById('networkResults').textContent
                };
            } else if (type === 'web') {
                data = {
                    scan_type: 'web',
                    timestamp: new Date().toISOString(),
                    results: document.getElementById('webResults').textContent
                };
            }

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);

            addLogEntry(`[EXPORT] Results exported as ${filename}`);
        }

        function generateReport() {
            addLogEntry('[REPORTS] Generating comprehensive security report...');

            setTimeout(() => {
                const report = {
                    title: 'CyberSentinel Pro Security Assessment Report',
                    generated: new Date().toISOString(),
                    summary: 'Comprehensive security assessment completed',
                    findings: []
                };

                const reportJson = JSON.stringify(report, null, 2);
                const blob = new Blob([reportJson], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `security-report-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);

                addLogEntry('[REPORTS] Security report generated and downloaded');
                document.getElementById('totalReports').textContent =
                    parseInt(document.getElementById('totalReports').textContent) + 1;
            }, 2000);
        }

        function saveSettings() {
            const openaiKey = document.getElementById('openaiKey').value;
            const scanTimeout = document.getElementById('scanTimeout').value;
            const maxThreads = document.getElementById('maxThreads').value;
            const apiPort = document.getElementById('apiPort').value;

            // Save to localStorage for demo purposes
            const settings = {
                openaiKey: openaiKey,
                scanTimeout: scanTimeout,
                maxThreads: maxThreads,
                apiPort: apiPort
            };

            localStorage.setItem('cybersentinel-settings', JSON.stringify(settings));
            addLogEntry('[SETTINGS] Configuration saved successfully');

            // Update AI status if API key is provided
            if (openaiKey) {
                document.getElementById('aiStatus').className = 'status-dot status-online';
                // Hide API config section and show configured section
                document.getElementById('apiConfigSection').style.display = 'none';
                document.getElementById('apiConfiguredSection').style.display = 'block';
                // Update AI Analysis messages
                document.getElementById('aiConfigMessage').style.display = 'none';
                document.getElementById('aiReadyMessage').style.display = 'block';
            } else {
                // Show API config section if no key is saved
                document.getElementById('apiConfigSection').style.display = 'block';
                document.getElementById('apiConfiguredSection').style.display = 'none';
                // Update AI Analysis messages
                document.getElementById('aiConfigMessage').style.display = 'block';
                document.getElementById('aiReadyMessage').style.display = 'none';
            }

            alert('Settings saved successfully!');
        }

        function loadSettings() {
            const saved = localStorage.getItem('cybersentinel-settings');
            if (saved) {
                const settings = JSON.parse(saved);
                document.getElementById('openaiKey').value = settings.openaiKey || '';
                document.getElementById('scanTimeout').value = settings.scanTimeout || '30';
                document.getElementById('maxThreads').value = settings.maxThreads || '10';
                document.getElementById('apiPort').value = settings.apiPort || '8000';

                if (settings.openaiKey) {
                    document.getElementById('aiStatus').className = 'status-dot status-online';
                    // Hide API config section and show configured section
                    document.getElementById('apiConfigSection').style.display = 'none';
                    document.getElementById('apiConfiguredSection').style.display = 'block';
                    // Update AI Analysis messages
                    document.getElementById('aiConfigMessage').style.display = 'none';
                    document.getElementById('aiReadyMessage').style.display = 'block';
                } else {
                    // Show API config section if no key is saved
                    document.getElementById('apiConfigSection').style.display = 'block';
                    document.getElementById('apiConfiguredSection').style.display = 'none';
                    // Update AI Analysis messages
                    document.getElementById('aiConfigMessage').style.display = 'block';
                    document.getElementById('aiReadyMessage').style.display = 'none';
                }
            } else {
                // Show API config section if no settings are saved
                document.getElementById('apiConfigSection').style.display = 'block';
                document.getElementById('apiConfiguredSection').style.display = 'none';
                // Update AI Analysis messages
                document.getElementById('aiConfigMessage').style.display = 'block';
                document.getElementById('aiReadyMessage').style.display = 'none';
            }
        }

        function reconfigureAPI() {
            // Show API config section and hide configured section
            document.getElementById('apiConfigSection').style.display = 'block';
            document.getElementById('apiConfiguredSection').style.display = 'none';
            // Clear the input field
            document.getElementById('openaiKey').value = '';
            // Update AI Analysis messages
            document.getElementById('aiConfigMessage').style.display = 'block';
            document.getElementById('aiReadyMessage').style.display = 'none';
            addLogEntry('[SETTINGS] API reconfiguration initiated');
        }

        // Novel predictive defense execution with simulated results
        function runPredictiveDefense(button, mode) {
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner"></div> Rendering Future Mesh...';

            const consoleEl = document.getElementById('predictiveConsole');
            const exportButton = document.getElementById('exportPredictiveBtn');
            updateScanStatus('scanning');
            addLogEntry(`[HYPERION] Initiating ${mode} projection kernel`);

            const narratives = {
                temporal: [
                    '// Synthesizing temporal breach vectors...\n',
                    '[T+6h] Credential-stuffing surges detected targeting lateral SSO connectors.\n',
                    '[T+14h] Emerging fork of public P2P botnet aligning with your CDN subnets.\n',
                    '[T+28h] Insider signal anomaly  anomalous access request to vault cluster.\n',
                    '\nRisk Amplification: 0.68  0.83\nRecommended Counter-Move: Prioritize credential rotation gating and isolation of SSO edges.'
                ],
                persona: [
                    '// Composing adversary persona atlas...\n',
                    'Persona Codename: GLACIER-MERIDIAN\n',
                    'Toolchain DNA: Living-off-the-land (LOTL) orchestration, covert TLS pivots.\n',
                    'Motivations: Supply chain disruption during quarterly reconciliation.\n',
                    'Behavior Forecast: Prefers low-noise privilege escalation with signed binaries.\n',
                    '\nIntervention Vector: Deploy behavioral guardians on finance identity perimeter.'
                ],
                harmonics: [
                    '// Tuning zero-day harmonics radar...\n',
                    'Resonance Spike: CVE-unpublished/Graphite-Slipstream (crypto wallet libraries).\n',
                    'Telemetry Signature: Obfuscated YAML loader calling GPU kernels.\n',
                    'Community Chatter: 12 dark threads mapping exploit skeleton.\n',
                    '\nPre-Weaponization Buffer: ~18 hours\nDirective: Quarantine GPU-accelerated modules pending vendor attestation.'
                ]
            };

            consoleEl.textContent = '';
            let index = 0;
            const lines = narratives[mode] || ['// Projection kernel unavailable'];

            const interval = setInterval(() => {
                if (index >= lines.length) {
                    clearInterval(interval);
                    button.disabled = false;
                    button.innerHTML = originalText;
                    exportButton.style.display = 'inline-flex';
                    updateScanStatus('offline');
                    addLogEntry(`[HYPERION] ${mode} forecast complete`);
                    return;
                }
                const line = document.createElement('div');
                line.className = 'novel-console-line';
                line.textContent = lines[index];
                consoleEl.appendChild(line);
                consoleEl.scrollTop = consoleEl.scrollHeight;
                index++;
            }, 600);
        }

        function generateDeceptionMesh(button, variant = 'synthesis') {
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner"></div> Spinning counter-narratives...';

            addLogEntry(`[GIS] Deploying ${variant} deception construct`);

            const meshMatrix = document.getElementById('meshMatrix');
            const consoleEl = document.getElementById('deceptionConsole');

            const matrixTemplates = {
                synthesis: [
                    { label: 'Honey SSO', hint: 'Mirrors production latency / telemetry capture armed' },
                    { label: 'Phantom Vault', hint: 'Encrypted decoy with deep trace beacons' },
                    { label: 'Replica API', hint: 'AI-generated schema seeded with legal traps' },
                    { label: 'Ghost Credentials', hint: 'Ephemeral secrets bound to deception mesh' }
                ],
                routes: [
                    { label: 'Cascade Loop', hint: 'Auto reorients intruder into forensic maze' },
                    { label: 'Nebula Path', hint: 'Latency-matched to production edge to avoid suspicion' },
                    { label: 'Quantum Fork', hint: 'Divergent network illusions shadowing real assets' },
                    { label: 'Shadow Transit', hint: 'Records pivot cadence + tooling fingerprint' }
                ],
                telemetry: [
                    { label: 'Intent Weave', hint: 'Extracts adversary cognitive biases' },
                    { label: 'Toolchain Loom', hint: 'Maps binary lineage in real-time' },
                    { label: 'Pivot Pulse', hint: 'Predicts next lateral move with 92% confidence' },
                    { label: 'Exfil Ward', hint: 'Decoys exfil routes into isolated sandboxes' }
                ]
            };

            meshMatrix.innerHTML = '';
            (matrixTemplates[variant] || matrixTemplates.synthesis).forEach(entry => {
                const cell = document.createElement('div');
                cell.className = 'matrix-cell';
                cell.innerHTML = `<strong>${entry.label}</strong><span>${entry.hint}</span>`;
                meshMatrix.appendChild(cell);
            });

            consoleEl.textContent = `// ${variant.toUpperCase()} mesh deployed.\n// Telemetry siphons active. Monitoring adversary resonance...`;

            setTimeout(() => {
                button.disabled = false;
                button.innerHTML = originalText;
                addLogEntry('[GIS] Deception mesh propagation stabilized');
            }, 2600);
        }

        function updateTwinTimeline(hours) {
            document.getElementById('twinMarker').textContent = `+${hours}h`;
            document.getElementById('twinSynopsis').textContent = `Projecting control drift ${hours} hours into future. Awaiting scenario weave.`;
        }

        function runPostureSimulation(button) {
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<div class="loading-spinner"></div> Weaving scenarios...';

            const timeline = document.getElementById('twinTimeline').value;
            const eventsTrack = document.getElementById('twinTimelineEvents');
            const consoleEl = document.getElementById('twinConsole');
            const resilience = document.getElementById('resilienceScore');

            eventsTrack.innerHTML = '';
            consoleEl.textContent = '// Running sentient twin inference...';
            addLogEntry('[SENTIENT] Posture twin simulation engaged');

            const eventBlueprints = [
                { title: '+6h Control Drift', detail: 'IAM drift detected  rotating keys stale by ~19 days.' },
                { title: '+18h Threat Injection', detail: 'Shadow config changes traced to ungoverned automation pipeline.' },
                { title: '+32h Resilience Pulse', detail: 'Self-healing routines restore net posture to 84% if executed.' }
            ];

            eventBlueprints.forEach((event, idx) => {
                const node = document.createElement('div');
                node.className = 'timeline-event';
                node.innerHTML = `<h4>${event.title}</h4><p>${event.detail}</p>`;
                setTimeout(() => {
                    eventsTrack.appendChild(node);
                    eventsTrack.scrollTop = eventsTrack.scrollHeight;
                }, idx * 900);
            });

            setTimeout(() => {
                resilience.textContent = `Projected resilience at +${timeline}h: ${(76 + Math.random() * 8).toFixed(1)}%`;
                consoleEl.textContent = `// Scenario weave across +${timeline}h complete.\n// Feed simulations into governance council for rapid instrumentation.`;
                button.disabled = false;
                button.innerHTML = originalText;
                addLogEntry('[SENTIENT] Posture twin scenario complete');
            }, 3200);
        }

        function exportNovelResults(domain) {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const filename = `cybersentinel-${domain}-intelligence-${timestamp}.json`;
            const payload = {
                domain,
                generated_at: new Date().toISOString(),
                predictive_console: document.getElementById('predictiveConsole')?.innerText || null,
                deception_console: document.getElementById('deceptionConsole')?.innerText || null,
                mesh_matrix: Array.from(document.getElementById('meshMatrix')?.querySelectorAll('.matrix-cell strong') || []).map(el => el.textContent),
                twin_console: document.getElementById('twinConsole')?.innerText || null,
                twin_resilience: document.getElementById('resilienceScore')?.textContent || null,
                quantum_console: document.getElementById('quantumConsole')?.innerText || null,
                quantum_value: document.getElementById('gaugeValue')?.textContent || null,
                memetic_nodes: Array.from(document.getElementById('memeticCanvas')?.querySelectorAll('.memetic-node strong') || []).map(el => el.textContent)
            };

            const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
            addLogEntry(`[EXPORT] ${domain} intelligence exported to ${filename}`);
        }

        function initializeQuantumPrism() {
            renderQuantumGauge(quantumState.value);
            renderMemeticCanvas('baseline');
        }

        function renderQuantumGauge(value) {
            const needle = document.getElementById('gaugeNeedle');
            const display = document.getElementById('gaugeValue');
            if (!needle || !display) return;

            const clamped = Math.max(1, Math.min(99, value));
            const degrees = (clamped / 100) * 260 - 130;
            needle.style.transform = `rotate(${degrees}deg)`;
            display.textContent = clamped.toFixed(0);
        }

        function appendQuantumLog(message) {
            const consoleEl = document.getElementById('quantumConsole');
            if (!consoleEl) return;
            const line = document.createElement('div');
            line.className = 'novel-console-line';
            line.textContent = message;
            consoleEl.appendChild(line);
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        function triggerQuantumPulse(mode) {
            const adjustments = {
                supply_chain: { delta: 12, narrative: '[SUPPLY-CHAIN] Resonance spike from procurement microservices.' },
                insider: { delta: 8, narrative: '[INSIDER] Elevated insider flux from identity mesh anomaly.' },
                zero_day: { delta: 16, narrative: '[ZERO-DAY] Harmonics bloom around unpublished exploit scaffold.' }
            };

            const profile = adjustments[mode] || { delta: 5, narrative: '[QUANTUM] Generic disturbance injected.' };
            const jitter = (Math.random() * 6) - 3;
            quantumState.value = Math.max(5, Math.min(95, quantumState.value + profile.delta + jitter));
            quantumState.history.push({ timestamp: Date.now(), value: quantumState.value, mode });

            renderQuantumGauge(quantumState.value);
            appendQuantumLog(`${new Date().toLocaleTimeString()} :: ${profile.narrative}`);
            addLogEntry(`[QUANTUM] ${mode} pulse recalibrated coherence to ${quantumState.value.toFixed(0)}`);
        }

        function renderMemeticCanvas(flavor) {
            const canvas = document.getElementById('memeticCanvas');
            if (!canvas) return;
            canvas.innerHTML = '';
            (memeticBlueprints[flavor] || memeticBlueprints.baseline).forEach(node => {
                const el = document.createElement('div');
                el.className = 'memetic-node';
                el.innerHTML = `<strong>${node.name}</strong><span>${node.detail}</span>`;
                canvas.appendChild(el);
            });
        }

        function synthesizeMemeticThreat(flavor) {
            renderMemeticCanvas(flavor);
            const phrases = {
                collusion: '[MEMETIC] Collusion thread woven across supplier adjacency graph.',
                disruption: '[MEMETIC] Disruption wave forecasting emergent sabotage narrative.',
                espionage: '[MEMETIC] Espionage signal indicates covert reconnaissance through partner mesh.'
            };
            appendQuantumLog(`${new Date().toLocaleTimeString()} :: ${phrases[flavor] || '[MEMETIC] Canvas refreshed.'}`);
            addLogEntry('[QUANTUM] Memetic atlas recalibrated');
        }

        // Virtual Labs Functions
        function executeVMAction() {
            const provider = document.getElementById('vmProvider').value;
            const action = document.getElementById('vmAction').value;
            const vmName = document.getElementById('vmName').value.trim();
            const template = document.getElementById('vmTemplate').value;

            if (!vmName && action !== 'list') {
                alert('Please enter a VM name for this action');
                return;
            }

            addLogEntry(`[VM-${provider.toUpperCase()}] Executing ${action} on ${vmName || 'all VMs'}`);

            // Simulate VM operations
            const consoleEl = document.getElementById('vmConsole');
            const timestamp = new Date().toLocaleTimeString();

            let output = `\n[${timestamp}] [VM-${provider.toUpperCase()}] ${action.toUpperCase()} operation initiated...\n`;

            switch(action) {
                case 'list':
                    output += `Listing all VMs for ${provider}:\n`;
                    output += ` Kali-Linux-01 (Running) - 192.168.56.101\n`;
                    output += ` Metasploitable-3 (Stopped) - N/A\n`;
                    output += ` Windows-10-Test (Paused) - 192.168.56.102\n`;
                    break;
                case 'start':
                    output += `Starting VM: ${vmName}\n`;
                    output += ` Powering on virtual machine...\n`;
                    output += ` Allocating resources (RAM: 4GB, CPU: 2 cores)\n`;
                    output += ` Network interface configured\n`;
                    output += ` VM ${vmName} is now running\n`;
                    break;
                case 'stop':
                    output += `Stopping VM: ${vmName}\n`;
                    output += ` Sending shutdown signal...\n`;
                    output += ` Waiting for graceful shutdown...\n`;
                    output += ` VM ${vmName} stopped successfully\n`;
                    break;
                case 'create':
                    output += `Creating new VM: ${vmName}\n`;
                    output += `Template: ${template}\n`;
                    output += ` Creating virtual disk (50GB)...\n`;
                    output += ` Configuring hardware settings...\n`;
                    output += ` Installing OS from template...\n`;
                    output += ` VM ${vmName} created and ready to start\n`;
                    break;
                case 'delete':
                    if (confirm(`Are you sure you want to delete VM: ${vmName}? This action cannot be undone.`)) {
                        output += `Deleting VM: ${vmName}\n`;
                        output += ` Removing virtual machine...\n`;
                        output += ` Cleaning up virtual disks...\n`;
                        output += ` VM ${vmName} deleted successfully\n`;
                    } else {
                        output += `Delete operation cancelled by user\n`;
                    }
                    break;
                case 'snapshot':
                    output += `Creating snapshot for VM: ${vmName}\n`;
                    output += ` Pausing VM temporarily...\n`;
                    output += ` Capturing system state...\n`;
                    output += ` Snapshot 'backup-${Date.now()}' created\n`;
                    output += ` VM resumed\n`;
                    break;
                case 'clone':
                    const cloneName = `${vmName}-clone`;
                    output += `Cloning VM: ${vmName}  ${cloneName}\n`;
                    output += ` Copying virtual disk...\n`;
                    output += ` Duplicating configuration...\n`;
                    output += ` Clone ${cloneName} created successfully\n`;
                    break;
            }

            consoleEl.textContent += output;
            consoleEl.scrollTop = consoleEl.scrollHeight;

            // Update VM list after operations
            setTimeout(() => {
                refreshVMList();
            }, 1000);
        }

        function refreshVMList() {
            addLogEntry('[VM] Refreshing VM inventory...');

            // Simulate refreshing the VM list
            setTimeout(() => {
                const vmList = document.getElementById('vmList');
                // In a real implementation, this would fetch from the API
                addLogEntry('[VM] VM inventory refreshed - 3 VMs detected');
            }, 500);
        }

        function connectToVM() {
            const vmName = document.getElementById('vmName').value.trim();
            if (!vmName) {
                alert('Please enter a VM name to connect to');
                return;
            }

            addLogEntry(`[VM] Initiating connection to ${vmName}...`);

            // Simulate connection
            const consoleEl = document.getElementById('vmConsole');
            const timestamp = new Date().toLocaleTimeString();

            const output = `\n[${timestamp}] [VM-CONNECT] Connecting to ${vmName}...\n`;
            output += ` Establishing SSH connection...\n`;
            output += ` Authentication successful\n`;
            output += ` Connected to ${vmName} (192.168.56.101)\n`;
            output += ` Terminal session ready\n\n`;
            output += `root@${vmName}:~$ `;

            consoleEl.textContent += output;
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        function exportVMConfig() {
            const provider = document.getElementById('vmProvider').value;
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const filename = `vm-config-${provider}-${timestamp}.json`;

            const config = {
                provider: provider,
                export_timestamp: new Date().toISOString(),
                vms: [
                    {
                        name: 'Kali-Linux-01',
                        status: 'running',
                        ip: '192.168.56.101',
                        specs: { ram: '4GB', storage: '50GB', cpu: '2 cores' },
                        uptime: '2h 15m'
                    },
                    {
                        name: 'Metasploitable-3',
                        status: 'stopped',
                        ip: null,
                        specs: { ram: '2GB', storage: '30GB', cpu: '1 core' },
                        last_run: '1 day ago'
                    },
                    {
                        name: 'Windows-10-Test',
                        status: 'paused',
                        ip: '192.168.56.102',
                        specs: { ram: '8GB', storage: '100GB', cpu: '4 cores' },
                        uptime: '45m'
                    }
                ],
                network_config: {
                    type: 'host-only',
                    subnet: '192.168.56.0/24',
                    gateway: '192.168.56.1'
                }
            };

            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);

            addLogEntry(`[VM] Configuration exported as ${filename}`);
        }

        function filterVMs(status) {
            const vmCards = document.querySelectorAll('.vm-card');

            vmCards.forEach(card => {
                const vmStatus = card.querySelector('.vm-status').textContent.toLowerCase();
                if (status === 'all' || vmStatus === status) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });

            addLogEntry(`[VM] Filtered VMs by status: ${status}`);
        }

        // Individual VM action functions
        function startVM(vmName) {
            addLogEntry(`[VM] Starting ${vmName}...`);
            document.getElementById('vmName').value = vmName;
            document.getElementById('vmAction').value = 'start';
            executeVMAction();
        }

        function stopVM(vmName) {
            addLogEntry(`[VM] Stopping ${vmName}...`);
            document.getElementById('vmName').value = vmName;
            document.getElementById('vmAction').value = 'stop';
            executeVMAction();
        }

        function connectVM(vmName) {
            document.getElementById('vmName').value = vmName;
            connectToVM();
        }

        function snapshotVM(vmName) {
            addLogEntry(`[VM] Creating snapshot for ${vmName}...`);
            document.getElementById('vmName').value = vmName;
            document.getElementById('vmAction').value = 'snapshot';
            executeVMAction();
        }

        function resumeVM(vmName) {
            addLogEntry(`[VM] Resuming ${vmName}...`);
            document.getElementById('vmName').value = vmName;
            document.getElementById('vmAction').value = 'start';
            executeVMAction();
        }

        function revertVM(vmName) {
            if (confirm(`Revert ${vmName} to last snapshot?`)) {
                addLogEntry(`[VM] Reverting ${vmName} to snapshot...`);
                // Simulate revert operation
                const consoleEl = document.getElementById('vmConsole');
                const timestamp = new Date().toLocaleTimeString();
                const output = `\n[${timestamp}] [VM] Reverting ${vmName} to last snapshot...\n VM reverted successfully\n`;
                consoleEl.textContent += output;
                consoleEl.scrollTop = consoleEl.scrollHeight;
            }
        }

        function configureVM(vmName) {
            addLogEntry(`[VM] Opening configuration for ${vmName}...`);
            // In a real implementation, this would open a configuration modal
            alert(`Configuration panel for ${vmName} would open here.\n\nFeatures would include:\n Hardware settings (RAM, CPU, storage)\n Network configuration\n Shared folders\n Snapshots management\n Advanced options`);
        }

        // Check API server status
        async function checkApiStatus() {
            try {
                const response = await fetch(`${API_BASE_URL}/health`);
                if (response.ok) {
                    document.getElementById('apiStatus').className = 'status-dot status-online';
                    addLogEntry('[SYSTEM] API server connection established');
                } else {
                    throw new Error('API server not responding');
                }
            } catch (error) {
                document.getElementById('apiStatus').className = 'status-dot status-offline';
                addLogEntry('[WARNING] API server not available - running in demo mode');
            }
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            initNavigation();
            loadSettings();
            checkApiStatus();
            initializeQuantumPrism();

            addLogEntry('[SYSTEM] CyberSentinel Pro interface initialized');
            addLogEntry('[INFO] Welcome to the most advanced cybersecurity platform');
            addLogEntry('[STATUS] All systems ready for penetration testing operations');
        });

        // Auto-refresh status indicators
        setInterval(() => {
            const now = new Date();
            const indicators = document.querySelectorAll('.status-dot');
            indicators.forEach(indicator => {
                if (indicator.classList.contains('status-online')) {
                    // Add subtle animation to online indicators
                    indicator.style.boxShadow = `0 0 10px ${indicator.classList.contains('status-online') ? '#00cc66' : '#ff3366'}`;
                }
            });
        }, 2000);
    </script>
</body>
</html>
